import{b as ae,d as te,e as Q,f as R,Q as le,_ as ne,a as re}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-2d866a3c.js";import{d as A,y as F,n as Z,o as m,e as S,a as e,w as o,u as t,c as g,h as i,ac as O,ai as se,F as K,p as G,b as _,ab as k,q as W,k as B,aj as ie,T as E,ad as H,j as D,i as M,g as h,ae as V,af as q,f as ue,l as T,m as N,B as de,ag as pe,Z as ce}from"./app-739fb669.js";import{u as _e,a as J,Q as x,b as me,c as fe,d as P,e as z,f as j}from"./use-dialog-plugin-component-50d342aa.js";import{c as Y,Q as U,g as ge,h as X,a as be,j as ye,_ as ke}from"./ProyekDeleteDialog.vue_vue_type_script_setup_true_lang-db61d37e.js";import{Q as L}from"./QForm-92572154.js";import{m as I}from"./options-964f32b0.js";import"./QImg-454d5644.js";import"./_plugin-vue_export-helper-c27b6911.js";const he={class:"q-pa-md"},ve=A({__name:"RABTable",props:{rows:{},formOptions:{}},setup(v){const r=v,u=_e();function w(n){u.dialog({component:ke,componentProps:{proyek:n}})}function b(){u.dialog({component:$e,componentProps:{options:r.formOptions}})}function f(){u.dialog({component:Pe,componentProps:{options:r.formOptions}}).onOk(n=>{u.notify({type:n.type,message:n.message,position:"top"})})}function y(n){u.dialog({component:Se,componentProps:{rab:n,options:r.formOptions}}).onOk(l=>{u.notify({type:l.type,message:l.message,position:"top"})})}function C(n){u.dialog({component:je,componentProps:{id_rab:n}}).onOk(l=>{u.notify({type:l.type,message:l.message,position:"top"})})}const p=[{name:"nama_proyek",label:"Nama Proyek",field:"nama_proyek",align:"left",sortable:!0},{name:"pengguna_jasa",label:"Pengguna Jasa",field:"pengguna_jasa",align:"left",sortable:!0},{name:"penyedia_jasa",label:"Penyedia Jasa",field:"penyedia_jasa",align:"left",sortable:!0},{name:"tahun_anggaran",label:"Tahun Anggaran",field:"tahun_anggaran",align:"left",sortable:!0},{name:"status_rab",label:"Status",field:"status_rab",align:"left",sortable:!0},{name:"actions",label:"Actions",field:"",align:"left"}],s=F(!1);function c(){s.value=!s.value}return(n,l)=>{const d=Z("in-link");return m(),S("div",he,[e(me,{flat:"",bordered:"","row-key":"id_rab",rows:n.rows,columns:p,"rows-per-page-options":[10,15,20,25,50,0],fullscreen:s.value},{"top-left":o(()=>[t(Y)("create & modify rab")?(m(),g(i,{key:0,"no-caps":"",label:"Tambah RAB",icon:"add",color:"primary",onClick:f})):O("",!0)]),"top-right":o(()=>[Object.keys(n.$page.props.query).length?(m(),g(i,{key:0,flat:"","no-caps":"",label:"Clear Filter",icon:"clear",color:"secondary",onClick:l[0]||(l[0]=a=>t(se).visit(n.route("rab")))})):O("",!0),e(i,{flat:"","no-caps":"",label:"Pencarian",icon:"search",color:"primary",onClick:b}),e(i,{flat:"",dense:"",icon:s.value?"fullscreen_exit":"fullscreen",onClick:c,class:"q-ml-md"},null,8,["icon"])]),header:o(a=>[e(J,{props:a},{default:o(()=>[(m(!0),S(K,null,G(a.cols,$=>(m(),g(fe,{key:$.name,props:a,style:{"font-weight":"bold"}},{default:o(()=>[_(k($.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:o(a=>[e(J,{props:a},{default:o(()=>[e(x,{key:"nama_proyek",props:a},{default:o(()=>[e(i,{flat:"","no-caps":"",dense:"",color:"primary",ripple:!1,label:a.row.nama_proyek,onClick:$=>w(a.row)},{default:o(()=>[e(U,{anchor:"bottom middle",self:"top middle"},{default:o(()=>[_(" Lihat Detail ")]),_:1})]),_:2},1032,["label","onClick"])]),_:2},1032,["props"]),e(x,{key:"pengguna_jasa",props:a},{default:o(()=>[_(k(a.row.pengguna_jasa),1)]),_:2},1032,["props"]),e(x,{key:"penyedia_jasa",props:a},{default:o(()=>[_(k(a.row.penyedia_jasa),1)]),_:2},1032,["props"]),e(x,{key:"tahun_anggaran",props:a},{default:o(()=>[_(k(a.row.tahun_anggaran),1)]),_:2},1032,["props"]),e(x,{key:"status_rab",props:a},{default:o(()=>[t(ge)(a.row.status_aktivitas)?(m(),g(i,{key:0,flat:"",dense:"",round:"",color:"grey-6",icon:"warning",size:"sm"},{default:o(()=>[e(U,null,{default:o(()=>[_("Ditolak")]),_:1})]),_:1})):O("",!0),W(e(X,{color:a.row.status_rab==400?"red":"primary",label:a.row.status_rab==400?"Closed":"Open"},null,8,["color","label"]),[[d,n.route("detail_rab",a.row.id_rab)]])]),_:2},1032,["props"]),e(x,{key:"actions",props:a},{default:o(()=>[t(be)()||t(Y)("create & modify rab")&&t(ye)(a.row.status_rab)?(m(),g(i,{key:0,dense:"",flat:"",color:"blue-grey",icon:"more_vert"},{default:o(()=>[e(ae,{"auto-close":"","transition-show":"scale","transition-hide":"scale"},{default:o(()=>[e(te,{dense:"",style:{"min-width":"100px"}},{default:o(()=>[e(Q,{clickable:""},{default:o(()=>[e(R,{onClick:$=>y(a.row)},{default:o(()=>[_(" Edit ")]),_:2},1032,["onClick"])]),_:2},1024),e(B),e(Q,{clickable:""},{default:o(()=>[e(R,{class:"text-red",onClick:$=>C(a.row.id_rab)},{default:o(()=>[_(" Delete ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):(m(),g(i,{key:1,dense:"",flat:"",color:"grey-6",icon:"block"},{default:o(()=>[e(U,null,{default:o(()=>[_("Required permission")]),_:1})]),_:1}))]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","fullscreen"])])}}}),we=h("div",{class:"text-h6"},"Pencarian RAB",-1),Ce={class:"q-gutter-md"},Re={class:"text-primary"},$e=A({__name:"RABSearchDialog",props:{options:{}},emits:[...P.emits],setup(v){const r=v,{dialogRef:u,onDialogOK:w,onDialogCancel:b,onDialogHide:f}=P(),y=F(r.options.currentProyek);function C(l,d){d(()=>{y.value=I(l,r.options.currentProyek,["nama_proyek","tahun_anggaran"])})}const s=ie().props.query,c=E({id_proyek:s.id_proyek,status_rab:s.status_rab});function n(){c.get(route("rab"),{onSuccess:()=>w()})}return(l,d)=>(m(),g(H,{ref_key:"dialogRef",ref:u,onHide:t(f)},{default:o(()=>[e(N,{style:{width:"700px","max-width":"80vw"}},{default:o(()=>[e(D,{class:"row items-center q-pb-none"},{default:o(()=>[we,e(z),e(i,{flat:"",round:"",dense:"",icon:"close",onClick:t(b)},null,8,["onClick"])]),_:1}),e(B),e(L,{onSubmit:M(n,["prevent"])},{default:o(()=>[e(D,{class:"scroll"},{default:o(()=>[h("div",Ce,[e(j,{outlined:"",clearable:"","use-input":"","use-chips":"","emit-value":"","map-options":"",multiple:"","hide-bottom-space":"","input-debounce":"500",label:"Proyek",modelValue:t(c).id_proyek,"onUpdate:modelValue":d[0]||(d[0]=a=>t(c).id_proyek=a),"option-value":"id_proyek","option-label":a=>`${a.nama_proyek} | ${a.tahun_anggaran}`,options:y.value,error:!!t(c).errors.id_proyek,"error-message":t(c).errors.id_proyek,onFilter:C},{option:o(({itemProps:a,opt:$,selected:ee,toggleOption:oe})=>[e(Q,V(q(a)),{default:o(()=>[e(R,{side:""},{default:o(()=>[e(ue,{size:"sm","model-value":ee,"onUpdate:modelValue":Fe=>oe($)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024),e(R,null,{default:o(()=>[h("strong",Re,k($.nama_proyek),1),_(" "+k($.tahun_anggaran),1)]),_:2},1024)]),_:2},1040)]),"no-option":o(()=>[e(Q,null,{default:o(()=>[e(R,{class:"text-grey"},{default:o(()=>[_(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","option-label","options","error","error-message"]),e(j,{outlined:"",clearable:"","fill-input":"",label:"Status RAB",modelValue:t(c).status_rab,"onUpdate:modelValue":d[1]||(d[1]=a=>t(c).status_rab=a),options:[100,400]},{"selected-item":o(a=>[e(X,{color:a.opt==400?"red":"primary",label:a.opt==400?"Closed":"Open"},null,8,["color","label"])]),option:o(a=>[e(Q,V(q(a.itemProps)),{default:o(()=>[e(R,null,{default:o(()=>[_(k(a.opt==400?"Closed":"Open"),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue"])])]),_:1}),e(B),e(T,{align:"right"},{default:o(()=>[e(i,{flat:"",type:"submit",label:"Search",color:"primary",loading:t(c).processing},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["onHide"]))}}),Qe=h("div",{class:"text-h6"},"Tambah RAB",-1),Be={class:"q-gutter-md"},De={class:"text-primary"},Pe=A({__name:"RABCreateDialog",props:{options:{}},emits:[...P.emits],setup(v){const r=v,{dialogRef:u,onDialogOK:w,onDialogCancel:b,onDialogHide:f}=P(),y=F(r.options.proyek);function C(c,n){n(()=>{y.value=I(c,r.options.proyek,["nama_proyek","tahun_anggaran"])})}const p=E({id_proyek:null});function s(){p.post(route("rab.store"),{onSuccess:c=>{w({type:"positive",message:c.props.flash.success})}})}return(c,n)=>(m(),g(H,{ref_key:"dialogRef",ref:u,"no-backdrop-dismiss":!0,onHide:t(f)},{default:o(()=>[e(N,{style:{width:"700px","max-width":"80vw"}},{default:o(()=>[e(D,{class:"row items-center q-pb-none"},{default:o(()=>[Qe,e(z),e(i,{flat:"",round:"",dense:"",icon:"close",onClick:t(b)},null,8,["onClick"])]),_:1}),e(B),e(L,{onSubmit:M(s,["prevent"])},{default:o(()=>[e(D,{class:"scroll"},{default:o(()=>[h("div",Be,[e(j,{outlined:"",clearable:"","use-input":"","use-chips":"","emit-value":"","map-options":"","hide-bottom-space":"","input-debounce":"500",label:"Pilih Proyek",modelValue:t(p).id_proyek,"onUpdate:modelValue":n[0]||(n[0]=l=>t(p).id_proyek=l),"option-value":"id_proyek","option-label":l=>`${l.nama_proyek} | ${l.tahun_anggaran}`,options:y.value,error:!!t(p).errors.id_proyek,"error-message":t(p).errors.id_proyek,onFilter:C},{option:o(l=>[e(Q,V(q(l.itemProps)),{default:o(()=>[e(R,null,{default:o(()=>[h("strong",De,k(l.opt.nama_proyek),1),_(" "+k(l.opt.tahun_anggaran),1)]),_:2},1024)]),_:2},1040)]),"no-option":o(()=>[e(Q,null,{default:o(()=>[e(R,{class:"text-grey"},{default:o(()=>[_(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","option-label","options","error","error-message"])])]),_:1}),e(B),e(T,{align:"right"},{default:o(()=>[t(p).hasErrors?(m(),g(i,{key:0,flat:"",label:"Clear Errors",color:"red",onClick:n[1]||(n[1]=l=>t(p).clearErrors())})):O("",!0),e(i,{flat:"",label:"Reset",color:"secondary",onClick:n[2]||(n[2]=l=>t(p).reset())}),e(i,{flat:"",type:"submit",label:"Submit",color:"primary",loading:t(p).processing},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["onHide"]))}}),xe=h("div",{class:"text-h6"},"Edit RAB",-1),Ae={class:"q-gutter-md"},Oe={class:"text-primary"},Se=A({__name:"RABEditDialog",props:{rab:{},options:{}},emits:[...P.emits],setup(v){const r=v,{dialogRef:u,onDialogOK:w,onDialogCancel:b,onDialogHide:f}=P(),y={id_proyek:r.rab.id_proyek,nama_proyek:r.rab.nama_proyek,tahun_anggaran:r.rab.tahun_anggaran};de(()=>{r.options.proyek.push(y)});const C=F(r.options.proyek);function p(n,l){l(()=>{C.value=I(n,r.options.proyek,["nama_proyek","tahun_anggaran"])})}const s=E({id_rab:r.rab.id_rab,id_proyek:r.rab.id_proyek});function c(){s.patch(route("rab.update",r.rab.id_rab),{onSuccess:n=>{w({type:"positive",message:n.props.flash.success})}})}return(n,l)=>(m(),g(H,{ref_key:"dialogRef",ref:u,"no-backdrop-dismiss":!0,onHide:t(f)},{default:o(()=>[e(N,{style:{width:"700px","max-width":"80vw"}},{default:o(()=>[e(D,{class:"row items-center q-pb-none"},{default:o(()=>[xe,e(z),e(i,{flat:"",round:"",dense:"",icon:"close",onClick:t(b)},null,8,["onClick"])]),_:1}),e(B),e(L,{onSubmit:M(c,["prevent"])},{default:o(()=>[e(D,{class:"scroll"},{default:o(()=>[h("div",Ae,[e(j,{outlined:"",clearable:"","use-input":"","use-chips":"","emit-value":"","map-options":"","hide-bottom-space":"","input-debounce":"500",label:"Pilih Proyek",modelValue:t(s).id_proyek,"onUpdate:modelValue":l[0]||(l[0]=d=>t(s).id_proyek=d),"option-value":"id_proyek","option-label":d=>`${d.nama_proyek} | ${d.tahun_anggaran}`,options:C.value,error:!!t(s).errors.id_proyek,"error-message":t(s).errors.id_proyek,onFilter:p},{option:o(d=>[e(Q,V(q(d.itemProps)),{default:o(()=>[e(R,null,{default:o(()=>[h("strong",Oe,k(d.opt.nama_proyek),1),_(" "+k(d.opt.tahun_anggaran),1)]),_:2},1024)]),_:2},1040)]),"no-option":o(()=>[e(Q,null,{default:o(()=>[e(R,{class:"text-grey"},{default:o(()=>[_(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","option-label","options","error","error-message"])])]),_:1}),e(B),e(T,{align:"right"},{default:o(()=>[t(s).hasErrors?(m(),g(i,{key:0,flat:"",label:"Clear Errors",color:"red",onClick:l[1]||(l[1]=d=>t(s).clearErrors())})):O("",!0),e(i,{flat:"",label:"Reset",color:"secondary",onClick:l[2]||(l[2]=d=>t(s).reset())}),e(i,{flat:"",type:"submit",label:"Update",color:"primary",loading:t(s).processing},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["onHide"]))}}),Ve=h("div",{class:"text-h6"},"Delete Confirmation",-1),qe=h("span",{class:"q-ml-sm"},"Are you sure want to delete this data?",-1),je=A({__name:"RABDeleteDialog",props:{id_rab:{}},emits:[...P.emits],setup(v){const r=v,{dialogRef:u,onDialogOK:w,onDialogCancel:b,onDialogHide:f}=P(),y=E({id_rab:r.id_rab});function C(){y.delete(route("rab.destroy",r.id_rab),{onSuccess:p=>{w({type:"positive",message:p.props.flash.success})}})}return(p,s)=>(m(),g(H,{ref_key:"dialogRef",ref:u,"no-backdrop-dismiss":!0,onHide:t(f)},{default:o(()=>[e(N,null,{default:o(()=>[e(D,{class:"row items-center q-pb-none"},{default:o(()=>[Ve]),_:1}),e(B),e(D,{class:"row items-center"},{default:o(()=>[e(pe,{icon:"dangerous",color:"red","text-color":"white"}),qe]),_:1}),e(T,{align:"right"},{default:o(()=>[e(i,{flat:"",label:"Cancel",color:"primary",onClick:t(b)},null,8,["onClick"]),e(i,{flat:"",label:"Yes, delete it",color:"red",onClick:C})]),_:1})]),_:1})]),_:1},8,["onHide"]))}}),Le=A({__name:"RABPage",props:{rab:{},formOptions:{}},setup(v){const r=[{label:"Main",url:"#"},{label:"RAB",url:"#"}];return(u,w)=>{const b=Z("in-link");return m(),S(K,null,[e(t(ce),{title:"RAB"}),e(ne,null,{breadcrumbs:o(()=>[e(le,{align:"left"},{default:o(()=>[(m(),S(K,null,G(r,f=>W(e(re,{label:f.label},null,8,["label"]),[[b,f.url]])),64))]),_:1})]),default:o(()=>[e(t(ve),{rows:u.rab,"form-options":u.formOptions},null,8,["rows","form-options"])]),_:1})],64)}}});export{Le as default};
