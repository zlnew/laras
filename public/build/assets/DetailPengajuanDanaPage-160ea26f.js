import{i as la,d as K,e as X,f as ka,g as ha,Q as S,a as T,h as ia,b as ya,_ as va,c as Da}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-12264d28.js";import{d as E,l as M,j as Q,o as g,c as y,C as wa,w as e,a,b as r,t as u,u as t,A as H,g as m,h as v,y as ua,Q as N,e as L,k as aa,F as Y,f as oa,s as O,T as z,p as G,q as U,i as da,N as pa,P as ma,v as W,x as B,D as Pa,m as Va,Z as Ca,n as $a}from"./app-98415438.js";import{Q as xa,a as sa,b as Qa,c as ra,_ as Sa}from"./FileDeleteDialog.vue_vue_type_script_setup_true_lang-f5ae419d.js";import{f as Ta}from"./ProyekDeleteDialog.vue_vue_type_script_setup_true_lang-13d5be79.js";import{b as p,a as A,c as _a,d as ga,Q as J}from"./QTable-a233578c.js";import{Q as ea}from"./QTooltip-e1570a44.js";import{u as na}from"./use-quasar-52eeb4b4.js";import{a as I,t as x,s as ca}from"./money-915f7772.js";import{u as F,Q as ta}from"./use-dialog-plugin-component-530071f9.js";import{Q as fa}from"./QForm-90bf62d3.js";import{m as Z,f as ja}from"./options-4b88285e.js";import{Q as ba,_ as Ua}from"./ModuleTopSection.vue_vue_type_script_setup_true_lang-df930ee5.js";import"./QImg-24af00d1.js";import"./QFile-90a5ce7f.js";const qa={class:"q-gutter-sm"},Oa={key:1},Ra=E({__name:"PengajuanDanaItemTable",props:{rows:{},data:{},formOptions:{}},setup(w,{expose:i}){const f=w,j=M(()=>{const s=f.rows.reduce((V,R)=>V+I(R.jumlah_pengajuan),0),o=f.rows.reduce((V,R)=>n.value.includes(R.id_detail_pengajuan_dana)?V+I(R.jumlah_pengajuan):V,0),l=s-o;return{pengajuan:s,disetujui:o,ditolak:l}}),_=na();function d(){_.dialog({component:Ja,componentProps:{pengajuanDana:f.data.pengajuanDana,options:f.formOptions}}).onOk(s=>{_.notify({type:s.type,message:s.message,position:"top"})})}function b(s){_.dialog({component:Za,componentProps:{detailPengajuanDana:s,options:f.formOptions}}).onOk(o=>{_.notify({type:o.type,message:o.message,position:"top"})})}function h(s){_.dialog({component:Xa,componentProps:{id_detail_pengajuan_dana:s}}).onOk(o=>{_.notify({type:o.type,message:o.message,position:"top"})})}const k=[{name:"index",label:"#",field:"index"},{name:"uraian",label:"Uraian",field:"uraian",align:"left",sortable:!0},{name:"pos",label:"POS",field:"pos",align:"left",sortable:!0},{name:"jenis_pembayaran",label:"Jenis Pembayaran",field:"jenis_pembayaran",align:"left",sortable:!0},{name:"bank",label:"Bank",field:"nama_bank",align:"left",sortable:!0},{name:"rekening",label:"Rekening",field:"nomor_rekening",align:"left",sortable:!0},{name:"jumlah",label:"Jumlah Pengajuan",field:"jumlah_pengajuan",align:"right",sortable:!0},{name:"persetujuan",label:"Approval",field:"",align:"left"},{name:"actions",label:"Actions",field:"",align:"left"}],P=()=>{const s=[];return K("approve pengajuan dana")&&ia(f.data.pengajuanDana)?k.map(o=>s.push(o.name)):k.map(o=>{if(o.name!=="persetujuan")return s.push(o.name)}),s},C=Q(!1);function q(){C.value=!C.value}const c=Q(""),D=Q([]),n=M(()=>{const s=[];return D.value&&D.value.map(o=>s.push(o.id_detail_pengajuan_dana)),s}),$=M(()=>D.value?D.value.reduce((o,l)=>{const V=o.find(R=>R.id_detail_rap===l.id_detail_rap);return V!=null?V.jumlah_pengajuan+=I(l.jumlah_pengajuan):o.push({id_detail_rap:l.id_detail_rap,jumlah_pengajuan:I(l.jumlah_pengajuan)}),o},[]):[]);return i({selectedIds:n,approvedPengajuanSaatIni:$}),(s,o)=>(g(),y(_a,{flat:"",bordered:"","row-key":"id_detail_pengajuan_dana",rows:s.rows,columns:k,"visible-columns":P(),"rows-per-page-options":[10,15,20,25,50,0],fullscreen:C.value,filter:c.value,selection:"multiple",selected:D.value,"onUpdate:selected":o[1]||(o[1]=l=>D.value=l),class:"no-border"},wa({"top-left":e(()=>[m("div",qa,[t(la)()||t(K)("create & modify pengajuan dana")&&t(X)(s.data.pengajuanDana)?(g(),y(v,{key:0,"no-caps":"",label:"Tambah Uraian",icon:"add",color:"primary",onClick:d})):H("",!0)])]),"top-right":e(()=>[a(N,{dense:"",debounce:"300",modelValue:c.value,"onUpdate:modelValue":o[0]||(o[0]=l=>c.value=l),placeholder:"Search"},{append:e(()=>[a(ua,{name:"search"})]),_:1},8,["modelValue"]),a(v,{flat:"",dense:"",icon:C.value?"fullscreen_exit":"fullscreen",onClick:q,class:"q-ml-md"},null,8,["icon"])]),header:e(l=>[a(A,{props:l},{default:e(()=>[(g(!0),L(Y,null,aa(l.cols,V=>(g(),y(ga,{key:V.name,props:l,style:{"font-weight":"bold"}},{default:e(()=>[V.name==="persetujuan"?(g(),y(oa,{key:0,modelValue:l.selected,"onUpdate:modelValue":R=>l.selected=R,label:"Approval"},null,8,["modelValue","onUpdate:modelValue"])):(g(),L("span",Oa,u(V.label),1))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:e(l=>[a(A,{props:l},{default:e(()=>[a(p,{key:"index",props:l},{default:e(()=>[r(u(++l.rowIndex),1)]),_:2},1032,["props"]),a(p,{key:"uraian",props:l},{default:e(()=>[r(u(l.row.uraian),1)]),_:2},1032,["props"]),a(p,{key:"pos",props:l},{default:e(()=>[r(u(l.row.pos),1)]),_:2},1032,["props"]),a(p,{key:"jenis_pembayaran",props:l},{default:e(()=>[r(u(l.row.jenis_pembayaran),1)]),_:2},1032,["props"]),a(p,{key:"bank",props:l},{default:e(()=>[r(u(l.row.nama_bank),1)]),_:2},1032,["props"]),a(p,{key:"rekening",props:l},{default:e(()=>[r(u(l.row.nomor_rekening)+" - "+u(l.row.nama_rekening),1)]),_:2},1032,["props"]),a(p,{key:"jumlah",props:l},{default:e(()=>[r(u(t(x)(l.row.jumlah_pengajuan)),1)]),_:2},1032,["props"]),a(p,{key:"persetujuan",props:l},{default:e(()=>[a(oa,{modelValue:l.selected,"onUpdate:modelValue":V=>l.selected=V},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"]),a(p,{key:"actions",props:l},{default:e(()=>[t(la)()||t(K)("create & modify pengajuan dana")&&t(X)(s.data.pengajuanDana)?(g(),y(v,{key:0,dense:"",flat:"",color:"blue-grey",icon:"more_vert"},{default:e(()=>[a(ka,{"auto-close":"","transition-show":"scale","transition-hide":"scale"},{default:e(()=>[a(ha,{dense:"",style:{"min-width":"100px"}},{default:e(()=>[a(S,{clickable:""},{default:e(()=>[a(T,{onClick:V=>b(l.row)},{default:e(()=>[r(" Edit ")]),_:2},1032,["onClick"])]),_:2},1024),a(O),a(S,{clickable:""},{default:e(()=>[a(T,{class:"text-red",onClick:V=>h(l.row.id_detail_pengajuan_dana)},{default:e(()=>[r(" Delete ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):(g(),y(v,{key:1,dense:"",flat:"",color:"grey-6",icon:"block"},{default:e(()=>[a(ea,null,{default:e(()=>[r("Required permission")]),_:1})]),_:1}))]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:2},[s.rows.length?{name:"bottom-row",fn:e(()=>[a(A,{"no-hover":""},{default:e(()=>[a(p,{colspan:"5",style:{border:"none"}}),a(p,{class:"text-right"},{default:e(()=>[r(" Total Pengajuan ")]),_:1}),a(p,{class:"text-right text-weight-bold"},{default:e(()=>[r(u(t(x)(j.value.pengajuan)),1)]),_:1}),a(p,{style:{border:"none"}})]),_:1}),P().includes("persetujuan")?(g(),y(A,{key:0,"no-hover":""},{default:e(()=>[a(p,{colspan:"5",style:{border:"none"}}),a(p,{class:"text-right"},{default:e(()=>[r(" Total Disetujui ")]),_:1}),a(p,{class:"text-right text-weight-bold"},{default:e(()=>[r(u(t(x)(j.value.disetujui)),1)]),_:1}),a(p,{style:{border:"none"}})]),_:1})):H("",!0),P().includes("persetujuan")?(g(),y(A,{key:1,"no-hover":""},{default:e(()=>[a(p,{colspan:"5",style:{border:"none"}}),a(p,{class:"text-right"},{default:e(()=>[r(" Total Ditolak ")]),_:1}),a(p,{class:"text-right text-weight-bold"},{default:e(()=>[r(u(t(x)(j.value.ditolak)),1)]),_:1}),a(p,{style:{border:"none"}})]),_:1})):H("",!0)]),key:"0"}:void 0]),1032,["rows","visible-columns","fullscreen","filter","selected"]))}}),Ia=m("div",{class:"text-h6"},"Tambah Uraian Pengajuan Transaksi",-1),Fa={class:"q-gutter-md"},Ea={class:"row"},Aa={class:"col-12 col-md-6 q-pr-sm"},Ha={class:"col-12 col-md-6 q-pl-sm"},Na={class:"text-primary"},Ja=E({__name:"PengajuanDanaItemCreateDialog",props:{pengajuanDana:{},options:{}},emits:[...F.emits],setup(w){const i=w,{dialogRef:f,onDialogOK:j,onDialogCancel:_,onDialogHide:d}=F(),b=["Cash","Transfer"],h=Q(i.options.detailRap),k=Q(i.options.rekening),P=Q(b);function C(s,o){o(()=>{h.value=Z(s,i.options.detailRap,["uraian"])})}function q(s,o){o(()=>{k.value=Z(s,i.options.rekening,["nama_bank","nomor_rekening","nama_rekening"])})}function c(s,o){o(()=>{P.value=ja(s,b)})}async function D(s){if(typeof s=="string"){const o=await ca(s);n.jumlah_pengajuan=o}}const n=z({uraian:null,jumlah_pengajuan:0,jenis_pembayaran:null,id_detail_rap:null,id_rekening:null});function $(){n.post(route("detail_pengajuan_dana.store",i.pengajuanDana.id_pengajuan_dana),{onSuccess:s=>{j({type:"positive",message:s.props.flash.success})}})}return(s,o)=>(g(),y(G,{ref_key:"dialogRef",ref:f,"no-backdrop-dismiss":!0,onHide:t(d)},{default:e(()=>[a(B,{style:{width:"700px","max-width":"80vw"}},{default:e(()=>[a(U,{class:"row items-center q-pb-none"},{default:e(()=>[Ia,a(ta),a(v,{flat:"",round:"",dense:"",icon:"close",onClick:t(_)},null,8,["onClick"])]),_:1}),a(O),a(fa,{onSubmit:da($,["prevent"])},{default:e(()=>[a(U,{class:"scroll"},{default:e(()=>[m("div",Fa,[a(J,{outlined:"","use-input":"","emit-value":"","map-options":"","hide-bottom-space":"","input-debounce":"500",label:"POS",modelValue:t(n).id_detail_rap,"onUpdate:modelValue":o[0]||(o[0]=l=>t(n).id_detail_rap=l),"option-value":"id_detail_rap","option-label":"uraian",options:h.value,error:!!t(n).errors.id_detail_rap,"error-message":t(n).errors.id_detail_rap,onFilter:C},{"no-option":e(()=>[a(S,null,{default:e(()=>[a(T,{class:"text-grey"},{default:e(()=>[r(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","options","error","error-message"]),a(N,{outlined:"",autogrow:"","hide-bottom-space":"",label:"Uraian",modelValue:t(n).uraian,"onUpdate:modelValue":o[1]||(o[1]=l=>t(n).uraian=l),error:!!t(n).errors.uraian,"error-message":t(n).errors.uraian},null,8,["modelValue","error","error-message"]),m("div",Ea,[m("div",Aa,[a(N,{outlined:"","hide-bottom-space":"",label:"Jumlah Pengajuan",modelValue:t(n).jumlah_pengajuan,"onUpdate:modelValue":[o[2]||(o[2]=l=>t(n).jumlah_pengajuan=l),o[3]||(o[3]=l=>D(l))],hint:t(x)(t(n).jumlah_pengajuan),"hide-hint":t(n).jumlah_pengajuan<1,error:!!t(n).errors.jumlah_pengajuan,"error-message":t(n).errors.jumlah_pengajuan,"input-class":"text-right"},null,8,["modelValue","hint","hide-hint","error","error-message"])]),m("div",Ha,[a(J,{outlined:"","use-input":"","use-chips":"","hide-bottom-space":"","input-debounce":"500",label:"Jenis Pembayaran",modelValue:t(n).jenis_pembayaran,"onUpdate:modelValue":o[4]||(o[4]=l=>t(n).jenis_pembayaran=l),options:P.value,error:!!t(n).errors.jenis_pembayaran,"error-message":t(n).errors.jenis_pembayaran,onFilter:c},{"no-option":e(()=>[a(S,null,{default:e(()=>[a(T,{class:"text-grey"},{default:e(()=>[r(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","options","error","error-message"])])]),a(J,{outlined:"","use-input":"","use-chips":"","emit-value":"","map-options":"","hide-bottom-space":"","input-debounce":"500",label:"Rekening Pembayaran",modelValue:t(n).id_rekening,"onUpdate:modelValue":o[5]||(o[5]=l=>t(n).id_rekening=l),"option-value":"id_rekening","option-label":l=>`${l.nama_bank} | ${l.nomor_rekening} - ${l.nama_rekening}`,options:k.value,error:!!t(n).errors.id_rekening,"error-message":t(n).errors.id_rekening,onFilter:q},{option:e(l=>[a(S,pa(ma(l.itemProps)),{default:e(()=>[a(T,null,{default:e(()=>[m("strong",Na,u(l.opt.nama_bank),1),r(" "+u(l.opt.nomor_rekening)+" - "+u(l.opt.nama_rekening),1)]),_:2},1024)]),_:2},1040)]),"no-option":e(()=>[a(S,null,{default:e(()=>[a(T,{class:"text-grey"},{default:e(()=>[r(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","option-label","options","error","error-message"])])]),_:1}),a(O),a(W,{align:"right"},{default:e(()=>[t(n).hasErrors?(g(),y(v,{key:0,flat:"",label:"Clear Errors",color:"red",onClick:o[6]||(o[6]=l=>t(n).clearErrors())})):H("",!0),a(v,{flat:"",label:"Reset",color:"secondary",onClick:o[7]||(o[7]=l=>t(n).reset())}),a(v,{flat:"",type:"submit",label:"Submit",color:"primary",loading:t(n).processing},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["onHide"]))}}),Ba=m("div",{class:"text-h6"},"Edit Uraian Pengajuan Transaksi",-1),Ka={class:"q-gutter-md"},La={class:"row"},za={class:"col-12 col-md-6 q-pr-sm"},Ma={class:"col-12 col-md-6 q-pl-sm"},Ya={class:"text-primary"},Za=E({__name:"PengajuanDanaItemEditDialog",props:{detailPengajuanDana:{},options:{}},emits:[...F.emits],setup(w){const i=w,{dialogRef:f,onDialogOK:j,onDialogCancel:_,onDialogHide:d}=F(),b=["Cash","Transfer"],h=Q(i.options.detailRap),k=Q(i.options.rekening),P=Q(b);function C(s,o){o(()=>{h.value=Z(s,i.options.detailRap,["uraian"])})}function q(s,o){o(()=>{k.value=Z(s,i.options.rekening,["nama_bank","nomor_rekening","nama_rekening"])})}function c(s,o){o(()=>{P.value=ja(s,b)})}async function D(s){if(typeof s=="string"){const o=await ca(s);n.jumlah_pengajuan=o}}const n=z({uraian:i.detailPengajuanDana.uraian,jumlah_pengajuan:I(i.detailPengajuanDana.jumlah_pengajuan),jenis_pembayaran:i.detailPengajuanDana.jenis_pembayaran,id_detail_rap:i.detailPengajuanDana.id_detail_rap,id_rekening:i.detailPengajuanDana.id_rekening});function $(){n.patch(route("detail_pengajuan_dana.update",i.detailPengajuanDana.id_detail_pengajuan_dana),{onSuccess:s=>{j({type:"positive",message:s.props.flash.success})}})}return(s,o)=>(g(),y(G,{ref_key:"dialogRef",ref:f,"no-backdrop-dismiss":!0,onHide:t(d)},{default:e(()=>[a(B,{style:{width:"700px","max-width":"80vw"}},{default:e(()=>[a(U,{class:"row items-center q-pb-none"},{default:e(()=>[Ba,a(ta),a(v,{flat:"",round:"",dense:"",icon:"close",onClick:t(_)},null,8,["onClick"])]),_:1}),a(O),a(fa,{onSubmit:da($,["prevent"])},{default:e(()=>[a(U,{class:"scroll"},{default:e(()=>[m("div",Ka,[a(J,{outlined:"","use-input":"","emit-value":"","map-options":"","hide-bottom-space":"","input-debounce":"500",label:"POS",modelValue:t(n).id_detail_rap,"onUpdate:modelValue":o[0]||(o[0]=l=>t(n).id_detail_rap=l),"option-value":"id_detail_rap","option-label":"uraian",options:h.value,error:!!t(n).errors.id_detail_rap,"error-message":t(n).errors.id_detail_rap,onFilter:C},{"no-option":e(()=>[a(S,null,{default:e(()=>[a(T,{class:"text-grey"},{default:e(()=>[r(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","options","error","error-message"]),a(N,{outlined:"",autogrow:"","hide-bottom-space":"",label:"Uraian",modelValue:t(n).uraian,"onUpdate:modelValue":o[1]||(o[1]=l=>t(n).uraian=l),error:!!t(n).errors.uraian,"error-message":t(n).errors.uraian},null,8,["modelValue","error","error-message"]),m("div",La,[m("div",za,[a(N,{outlined:"","hide-bottom-space":"",label:"Jumlah Pengajuan",modelValue:t(n).jumlah_pengajuan,"onUpdate:modelValue":[o[2]||(o[2]=l=>t(n).jumlah_pengajuan=l),o[3]||(o[3]=l=>D(l))],hint:t(x)(t(n).jumlah_pengajuan),"hide-hint":t(n).jumlah_pengajuan<1,error:!!t(n).errors.jumlah_pengajuan,"error-message":t(n).errors.jumlah_pengajuan,"input-class":"text-right"},null,8,["modelValue","hint","hide-hint","error","error-message"])]),m("div",Ma,[a(J,{outlined:"","use-input":"","use-chips":"","hide-bottom-space":"","input-debounce":"500",label:"Jenis Pembayaran",modelValue:t(n).jenis_pembayaran,"onUpdate:modelValue":o[4]||(o[4]=l=>t(n).jenis_pembayaran=l),options:P.value,error:!!t(n).errors.jenis_pembayaran,"error-message":t(n).errors.jenis_pembayaran,onFilter:c},{"no-option":e(()=>[a(S,null,{default:e(()=>[a(T,{class:"text-grey"},{default:e(()=>[r(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","options","error","error-message"])])]),a(J,{outlined:"","use-input":"","use-chips":"","emit-value":"","map-options":"","hide-bottom-space":"","input-debounce":"500",label:"Rekening Pembayaran",modelValue:t(n).id_rekening,"onUpdate:modelValue":o[5]||(o[5]=l=>t(n).id_rekening=l),"option-value":"id_rekening","option-label":l=>`${l.nama_bank} | ${l.nomor_rekening} - ${l.nama_rekening}`,options:k.value,error:!!t(n).errors.id_rekening,"error-message":t(n).errors.id_rekening,onFilter:q},{option:e(l=>[a(S,pa(ma(l.itemProps)),{default:e(()=>[a(T,null,{default:e(()=>[m("strong",Ya,u(l.opt.nama_bank),1),r(" "+u(l.opt.nomor_rekening)+" - "+u(l.opt.nama_rekening),1)]),_:2},1024)]),_:2},1040)]),"no-option":e(()=>[a(S,null,{default:e(()=>[a(T,{class:"text-grey"},{default:e(()=>[r(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","option-label","options","error","error-message"])])]),_:1}),a(O),a(W,{align:"right"},{default:e(()=>[t(n).hasErrors?(g(),y(v,{key:0,flat:"",label:"Clear Errors",color:"red",onClick:o[6]||(o[6]=l=>t(n).clearErrors())})):H("",!0),a(v,{flat:"",label:"Reset",color:"secondary",onClick:o[7]||(o[7]=l=>t(n).reset())}),a(v,{flat:"",type:"submit",label:"Update",color:"primary",loading:t(n).processing},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["onHide"]))}}),Ga=m("div",{class:"text-h6"},"Delete Confirmation",-1),Wa=m("span",{class:"q-ml-sm"},"Are you sure want to delete this data?",-1),Xa=E({__name:"PengajuanDanaItemDeleteDialog",props:{id_detail_pengajuan_dana:{}},emits:[...F.emits],setup(w){const i=w,{dialogRef:f,onDialogOK:j,onDialogCancel:_,onDialogHide:d}=F(),b=z({id_detail_pengajuan_dana:i.id_detail_pengajuan_dana});function h(){b.delete(route("detail_pengajuan_dana.destroy",i.id_detail_pengajuan_dana),{onSuccess:k=>{j({type:"positive",message:k.props.flash.success})}})}return(k,P)=>(g(),y(G,{ref_key:"dialogRef",ref:f,"no-backdrop-dismiss":!0,onHide:t(d)},{default:e(()=>[a(B,null,{default:e(()=>[a(U,{class:"row items-center q-pb-none"},{default:e(()=>[Ga]),_:1}),a(O),a(U,{class:"row items-center"},{default:e(()=>[a(Pa,{icon:"dangerous",color:"red","text-color":"white"}),Wa]),_:1}),a(W,{align:"right"},{default:e(()=>[a(v,{flat:"",label:"Cancel",color:"primary",onClick:t(_)},null,8,["onClick"]),a(v,{flat:"",label:"Yes, delete it",color:"red",onClick:h})]),_:1})]),_:1})]),_:1},8,["onHide"]))}}),ae=E({__name:"PengajuanDanaSubmissionForm",props:{data:{}},setup(w){const i=w,f=na(),j=z({catatan:""});function _(){j.post(route("pengajuan_dana.submit",i.data.id_pengajuan_dana),{onSuccess:b=>{f.notify({type:"positive",message:b.props.flash.success,position:"top"})}})}function d(){f.dialog({title:"Submission Confirmation",message:"Are you sure want to use this action?",prompt:{outlined:!0,autogrow:!0,model:"",type:"text",placeholder:"Tambahkan Catatan"},color:"primary",cancel:!0,persistent:!0}).onOk(b=>{j.catatan=b,_()})}return(b,h)=>(g(),y(ba,{position:"bottom-right",offset:[18,18]},{default:e(()=>[a(v,{rounded:"",color:"primary",label:"Submit","icon-right":"check",onClick:d,class:"q-pa-md"},{default:e(()=>[a(ea,null,{default:e(()=>[r("Click to submit")]),_:1})]),_:1})]),_:1}))}}),ee=E({__name:"PengajuanDanaEvaluateForm",props:{data:{}},setup(w){const i=w,f=na();function j(){f.dialog({component:oe,componentProps:{data:i.data}}).onOk(_=>{f.notify({type:_.type,message:_.message,position:"top"})})}return(_,d)=>(g(),y(ba,{position:"bottom-right",offset:[18,18]},{default:e(()=>[a(v,{rounded:"",label:"Evaluasi",color:"primary",icon:"keyboard_arrow_left",onClick:j,class:"q-pa-md"},{default:e(()=>[a(ea,null,{default:e(()=>[r("Evaluasi Pengajuan")]),_:1})]),_:1})]),_:1}))}}),ne=m("div",{class:"text-h6"},"Lembar Evaluasi",-1),te={class:"q-gutter-md"},le={class:"q-gutter-md"},oe=E({__name:"PengajuanDanaEvaluationDialog",props:{data:{}},emits:[...F.emits],setup(w){const i=w,{dialogRef:f,onDialogOK:j,onDialogCancel:_,onDialogHide:d}=F(),b=M(()=>i.data.evaluasi.map(c=>{if(c.pengajuan_saat_ini="0",i.data.approvedPengajuanSaatIni!=null){const s=i.data.approvedPengajuanSaatIni.find(o=>o.id_detail_rap===c.id_detail_rap);s&&(c.pengajuan_saat_ini+=s.jumlah_pengajuan)}const D=c.pengajuan_lalu?c.pengajuan_lalu:"0",n=I(D)+I(c.pengajuan_saat_ini),$=I(c.total_harga)-n;return{...c,total_pengajuan:n,sisa_anggaran:$}})),h=z({selected_ids_detail_pengajuan_dana:i.data.selected_ids_detail_pengajuan_dana,catatan:null});function k(){h.post(route("pengajuan_dana.approve",i.data.id_pengajuan_dana),{onSuccess:c=>{j({type:"positive",message:c.props.flash.success})}})}function P(){h.post(route("pengajuan_dana.reject",i.data.id_pengajuan_dana),{onSuccess:c=>{j({type:"positive",message:c.props.flash.success})}})}const C=[{name:"index",label:"#",field:"index"},{name:"uraian",label:"Uraian",field:"uraian",align:"left",sortable:!0},{name:"nama_satuan",label:"Satuan",field:"nama_satuan",align:"left",sortable:!0},{name:"harga_satuan",label:"Harga Satuan",field:"harga_satuan",align:"right",sortable:!0},{name:"volume",label:"Volume",field:"volume",align:"left",sortable:!0},{name:"total_harga",label:"Total Harga",field:"total_harga",align:"right",sortable:!0},{name:"pengajuan_lalu",label:"Pengajuan Sebelumnya",field:"pengajuan_lalu",align:"right",sortable:!0},{name:"pengajuan_saat_ini",label:"Pengajuan Saat Ini",field:"",align:"right",sortable:!0},{name:"total_pengajuan",label:"Total Pengajuan",field:"",align:"right",sortable:!0},{name:"sisa_anggaran",label:"Sisa Anggaran",field:"",align:"right",sortable:!0}],q=Q();return(c,D)=>(g(),y(G,{ref_key:"dialogRef",ref:f,"no-backdrop-dismiss":!0,onHide:t(d)},{default:e(()=>[a(B,{style:{"max-width":"100vw"}},{default:e(()=>[a(U,{class:"row items-center q-pb-none"},{default:e(()=>[ne,a(ta),a(v,{flat:"",round:"",dense:"",icon:"close",onClick:t(_)},null,8,["onClick"])]),_:1}),a(O),a(U,{class:"scroll"},{default:e(()=>[m("div",te,[a(_a,{flat:"",bordered:"","row-key":"id_detail_rap",rows:b.value,columns:C,filter:q.value,"rows-per-page-options":[0],title:"Evaluasi Pengajuan Dana",style:{"max-height":"100vh"},"virtual-scroll":""},{"top-right":e(()=>[a(N,{dense:"",debounce:"300",modelValue:q.value,"onUpdate:modelValue":D[0]||(D[0]=n=>q.value=n),placeholder:"Search"},{append:e(()=>[a(ua,{name:"search"})]),_:1},8,["modelValue"])]),header:e(n=>[a(A,{props:n},{default:e(()=>[(g(!0),L(Y,null,aa(n.cols,$=>(g(),y(ga,{key:$.name,props:n,style:{"font-weight":"bold"}},{default:e(()=>[r(u($.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:e(n=>[a(A,{props:n},{default:e(()=>[a(p,{key:"index",props:n},{default:e(()=>[r(u(++n.rowIndex),1)]),_:2},1032,["props"]),a(p,{key:"uraian",props:n},{default:e(()=>[r(u(n.row.uraian),1)]),_:2},1032,["props"]),a(p,{key:"nama_satuan",props:n},{default:e(()=>[r(u(n.row.nama_satuan),1)]),_:2},1032,["props"]),a(p,{key:"harga_satuan",props:n},{default:e(()=>[r(u(t(x)(n.row.harga_satuan)),1)]),_:2},1032,["props"]),a(p,{key:"volume",props:n},{default:e(()=>[r(u(n.row.volume),1)]),_:2},1032,["props"]),a(p,{key:"total_harga",props:n},{default:e(()=>[r(u(t(x)(n.row.total_harga)),1)]),_:2},1032,["props"]),a(p,{key:"pengajuan_lalu",props:n},{default:e(()=>[r(u(t(x)(n.row.pengajuan_lalu)),1)]),_:2},1032,["props"]),a(p,{key:"pengajuan_saat_ini",props:n},{default:e(()=>[r(u(t(x)(n.row.pengajuan_saat_ini||0)),1)]),_:2},1032,["props"]),a(p,{key:"total_pengajuan",props:n},{default:e(()=>[r(u(t(x)(n.row.total_pengajuan)),1)]),_:2},1032,["props"]),a(p,{key:"sisa_anggaran",props:n},{default:e(()=>[r(u(t(x)(n.row.sisa_anggaran)),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","filter"])])]),_:1}),a(U,null,{default:e(()=>[m("div",le,[a(N,{outlined:"",autogrow:"",label:"Catatan",modelValue:t(h).catatan,"onUpdate:modelValue":D[1]||(D[1]=n=>t(h).catatan=n)},null,8,["modelValue"])])]),_:1}),a(O),a(W,{align:"right"},{default:e(()=>{var n,$;return[a(v,{flat:"",label:"Tolak",color:"red",loading:t(h).processing,disable:!!((n=c.data.selected_ids_detail_pengajuan_dana)!=null&&n.length),onClick:P},null,8,["loading","disable"]),a(v,{flat:"",label:"Approve",color:"primary",loading:t(h).processing,disable:!(($=c.data.selected_ids_detail_pengajuan_dana)!=null&&$.length),onClick:k},null,8,["loading","disable"])]}),_:1})]),_:1})]),_:1},8,["onHide"]))}}),se={class:"q-px-md q-pt-md"},re={class:"row"},ie=m("div",{class:"col-4 text-caption"}," Keperluan ",-1),ue={class:"col-8 text-subtitle2"},de=m("div",{class:"col-4 text-caption"}," Jenis Transaksi ",-1),pe={class:"col-8 text-subtitle2"},me=m("div",{class:"col-4 text-caption"}," Tanggal Pengajuan ",-1),_e={class:"col-8 text-subtitle2"},ge={class:"q-px-md q-pt-md"},xe=E({__name:"DetailPengajuanDanaPage",props:{pengajuanDana:{},detailPengajuanDana:{},dokumenPenunjang:{},evaluasi:{},formOptions:{},timeline:{}},setup(w){const i=w,f=[{label:"Keuangan",url:"#"},{label:"Pengajuan Transaksi",url:route("pengajuan_dana")},{label:i.pengajuanDana.nama_proyek,url:"#"}],j=Q("uraian"),_=Q();return(d,b)=>{const h=Va("in-link");return g(),L(Y,null,[a(t(Ca),{title:"Pengajuan Transaksi"}),a(va,null,{breadcrumbs:e(()=>[a(ya,{align:"left"},{default:e(()=>[(g(),L(Y,null,aa(f,k=>$a(a(Da,{key:k.label,label:k.label},null,8,["label"]),[[h,k.url]])),64))]),_:1})]),default:e(()=>{var k,P;return[a(Ua,{title:"Pengajuan Transaksi","timeline-title":"Timeline Pengajuan Transaksi",data:{proyek:d.pengajuanDana,status:d.pengajuanDana.status_pengajuan,timeline:d.timeline}},null,8,["data"]),m("div",se,[a(B,{flat:"",bordered:"",style:{"max-width":"500px"}},{default:e(()=>[a(U,null,{default:e(()=>[m("div",re,[ie,m("div",ue," : "+u(d.pengajuanDana.keperluan),1),de,m("div",pe," : "+u(d.pengajuanDana.jenis_transaksi),1),me,m("div",_e," : "+u(t(Ta)(d.pengajuanDana.tanggal_pengajuan)||"-"),1)])]),_:1})]),_:1})]),m("div",ge,[a(B,{flat:"",bordered:""},{default:e(()=>[a(xa,{modelValue:j.value,"onUpdate:modelValue":b[0]||(b[0]=C=>j.value=C),class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:e(()=>[a(sa,{"no-caps":"",name:"uraian",label:"Uraian"}),a(sa,{"no-caps":"",name:"dokumen",label:"Dokumen Penunjang"})]),_:1},8,["modelValue"]),a(O),a(Qa,{modelValue:j.value,"onUpdate:modelValue":b[1]||(b[1]=C=>j.value=C)},{default:e(()=>[a(ra,{class:"q-pa-none",name:"uraian"},{default:e(()=>[a(t(Ra),{ref_key:"table",ref:_,rows:d.detailPengajuanDana,data:{pengajuanDana:d.pengajuanDana},"form-options":d.formOptions},null,8,["rows","data","form-options"])]),_:1}),a(ra,{class:"q-pa-none",name:"dokumen"},{default:e(()=>[a(t(Sa),{rows:d.dokumenPenunjang,data:{model_id:d.pengajuanDana.id_pengajuan_dana,permissions:"create & modify pengajuan dana",status_aktivitas:d.pengajuanDana.status_aktivitas}},null,8,["rows","data"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),t(K)("create & modify pengajuan dana")&&t(X)(d.pengajuanDana)&&d.detailPengajuanDana.length?(g(),y(t(ae),{key:0,data:{id_pengajuan_dana:d.pengajuanDana.id_pengajuan_dana}},null,8,["data"])):H("",!0),t(K)("approve pengajuan dana")&&t(ia)(d.pengajuanDana)?(g(),y(t(ee),{key:1,data:{evaluasi:d.evaluasi,approvedPengajuanSaatIni:(k=_.value)==null?void 0:k.approvedPengajuanSaatIni,id_pengajuan_dana:d.pengajuanDana.id_pengajuan_dana,selected_ids_detail_pengajuan_dana:(P=_.value)==null?void 0:P.selectedIds}},null,8,["data"])):H("",!0)]}),_:1})],64)}}});export{xe as default};
