import{i as F,d as w,e as B,f as X,g as Y,Q as E,a as N,h as z,b as aa,_ as ea,c as na}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-b69e3ed2.js";import{d as M,l as q,j as P,o as p,c as _,D as ta,w as e,a,b as i,t as d,u,B as Q,g as f,h as V,z as la,Q as oa,e as $,k as Z,F as O,f as J,v as G,n as sa,Z as ua,y as R,s as ia,p as ra}from"./app-a9c22e82.js";import{Q as da,a as K,b as pa,c as L,_ as ma}from"./FileDeleteDialog.vue_vue_type_script_setup_true_lang-a192b7ec.js";import{f as ca}from"./ProyekDeleteDialog.vue_vue_type_script_setup_true_lang-29a71a0e.js";import{b as o,a as D,c as _a,d as fa}from"./QTable-0e41b0f2.js";import{Q as ga}from"./datetime-dc60c162.js";import{u as ja}from"./use-quasar-954ed4d5.js";import{a as T,t as I}from"./money-915f7772.js";import{e as ba,f as ka,b as ya,c as va,d as ha}from"./PengajuanDanaEvaluationDialog.vue_vue_type_script_setup_true_lang-712e6e03.js";import{_ as Da}from"./ModuleTopSection.vue_vue_type_script_setup_true_lang-430fdd1b.js";import"./QImg-b742b038.js";import"./use-dialog-plugin-component-646efe56.js";import"./QFile-41b2f763.js";import"./QForm-332245d0.js";import"./options-4b88285e.js";const wa={class:"q-gutter-sm"},Pa={key:1},Qa=M({__name:"PengajuanProyekItemTable",props:{rows:{},data:{},formOptions:{}},setup(C,{expose:x}){const g=C,j=q(()=>{const l=g.rows.reduce((r,k)=>r+T(k.jumlah_pengajuan),0),t=g.rows.reduce((r,k)=>A.value.includes(k.id_detail_pengajuan_dana)?r+T(k.jumlah_pengajuan):r,0),n=l-t;return{pengajuan:l,disetujui:t,ditolak:n}}),m=ja();function s(){m.dialog({component:ba,componentProps:{pengajuanDana:g.data.pengajuanDana,options:g.formOptions}}).onOk(l=>{m.notify({type:l.type,message:l.message,position:"top"})})}function y(l){m.dialog({component:ka,componentProps:{detailPengajuanDana:l,options:g.formOptions}}).onOk(t=>{m.notify({type:t.type,message:t.message,position:"top"})})}function S(l){m.dialog({component:ya,componentProps:{id_detail_pengajuan_dana:l}}).onOk(t=>{m.notify({type:t.type,message:t.message,position:"top"})})}const c=[{name:"index",label:"#",field:"index"},{name:"uraian",label:"Uraian",field:"uraian",align:"left",sortable:!0},{name:"pos",label:"POS",field:"pos",align:"left",sortable:!0},{name:"jenis_pembayaran",label:"Jenis Pembayaran",field:"jenis_pembayaran",align:"left",sortable:!0},{name:"bank",label:"Bank",field:"nama_bank",align:"left",sortable:!0},{name:"rekening",label:"Rekening",field:"nomor_rekening",align:"left",sortable:!0},{name:"jumlah",label:"Jumlah Pengajuan",field:"jumlah_pengajuan",align:"right",sortable:!0},{name:"persetujuan",label:"Approval",field:"",align:"left"},{name:"actions",label:"Actions",field:"",align:"left"}],v=()=>{const l=[];return w("approve pengajuan dana")&&z(g.data.pengajuanDana)?c.map(t=>l.push(t.name)):c.map(t=>{if(t.name!=="persetujuan")return l.push(t.name)}),l},b=P(!1);function H(){b.value=!b.value}const U=P(""),h=P([]),A=q(()=>{const l=[];return h.value&&h.value.map(t=>l.push(t.id_detail_pengajuan_dana)),l}),W=q(()=>h.value?h.value.reduce((t,n)=>{const r=t.find(k=>k.id_detail_rap===n.id_detail_rap);return r!=null?r.jumlah_pengajuan+=T(n.jumlah_pengajuan):t.push({id_detail_rap:n.id_detail_rap,jumlah_pengajuan:T(n.jumlah_pengajuan)}),t},[]):[]);return x({selectedIds:A,approvedPengajuanSaatIni:W}),(l,t)=>(p(),_(_a,{flat:"",bordered:"","row-key":"id_detail_pengajuan_dana",rows:l.rows,columns:c,"visible-columns":v(),"rows-per-page-options":[10,15,20,25,50,0],fullscreen:b.value,filter:U.value,selection:"multiple",selected:h.value,"onUpdate:selected":t[1]||(t[1]=n=>h.value=n),class:"no-border"},ta({"top-left":e(()=>[f("div",wa,[u(F)()||u(w)("create & modify pengajuan dana")&&u(B)(l.data.pengajuanDana)?(p(),_(V,{key:0,"no-caps":"",label:"Tambah Uraian",icon:"add",color:"primary",onClick:s})):Q("",!0)])]),"top-right":e(()=>[a(oa,{dense:"",debounce:"300",modelValue:U.value,"onUpdate:modelValue":t[0]||(t[0]=n=>U.value=n),placeholder:"Search"},{append:e(()=>[a(la,{name:"search"})]),_:1},8,["modelValue"]),a(V,{flat:"",dense:"",icon:b.value?"fullscreen_exit":"fullscreen",onClick:H,class:"q-ml-md"},null,8,["icon"])]),header:e(n=>[a(D,{props:n},{default:e(()=>[(p(!0),$(O,null,Z(n.cols,r=>(p(),_(fa,{key:r.name,props:n,style:{"font-weight":"bold"}},{default:e(()=>[r.name==="persetujuan"?(p(),_(J,{key:0,modelValue:n.selected,"onUpdate:modelValue":k=>n.selected=k,label:"Approval"},null,8,["modelValue","onUpdate:modelValue"])):(p(),$("span",Pa,d(r.label),1))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:e(n=>[a(D,{props:n},{default:e(()=>[a(o,{key:"index",props:n},{default:e(()=>[i(d(++n.rowIndex),1)]),_:2},1032,["props"]),a(o,{key:"uraian",props:n},{default:e(()=>[i(d(n.row.uraian),1)]),_:2},1032,["props"]),a(o,{key:"pos",props:n},{default:e(()=>[i(d(n.row.pos),1)]),_:2},1032,["props"]),a(o,{key:"jenis_pembayaran",props:n},{default:e(()=>[i(d(n.row.jenis_pembayaran),1)]),_:2},1032,["props"]),a(o,{key:"bank",props:n},{default:e(()=>[i(d(n.row.nama_bank),1)]),_:2},1032,["props"]),a(o,{key:"rekening",props:n},{default:e(()=>[i(d(n.row.nomor_rekening)+" - "+d(n.row.nama_rekening),1)]),_:2},1032,["props"]),a(o,{key:"jumlah",props:n},{default:e(()=>[i(d(u(I)(n.row.jumlah_pengajuan)),1)]),_:2},1032,["props"]),a(o,{key:"persetujuan",props:n},{default:e(()=>[a(J,{modelValue:n.selected,"onUpdate:modelValue":r=>n.selected=r},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"]),a(o,{key:"actions",props:n},{default:e(()=>[u(F)()||u(w)("create & modify pengajuan dana")&&u(B)(l.data.pengajuanDana)?(p(),_(V,{key:0,dense:"",flat:"",color:"blue-grey",icon:"more_vert"},{default:e(()=>[a(X,{"auto-close":"","transition-show":"scale","transition-hide":"scale"},{default:e(()=>[a(Y,{dense:"",style:{"min-width":"100px"}},{default:e(()=>[a(E,{clickable:""},{default:e(()=>[a(N,{onClick:r=>y(n.row)},{default:e(()=>[i(" Edit ")]),_:2},1032,["onClick"])]),_:2},1024),a(G),a(E,{clickable:""},{default:e(()=>[a(N,{class:"text-red",onClick:r=>S(n.row.id_detail_pengajuan_dana)},{default:e(()=>[i(" Delete ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):(p(),_(V,{key:1,dense:"",flat:"",color:"grey-6",icon:"block"},{default:e(()=>[a(ga,null,{default:e(()=>[i("Required permission")]),_:1})]),_:1}))]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:2},[l.rows.length?{name:"bottom-row",fn:e(()=>[a(D,{"no-hover":""},{default:e(()=>[a(o,{colspan:"5",style:{border:"none"}}),a(o,{class:"text-right"},{default:e(()=>[i(" Total Pengajuan ")]),_:1}),a(o,{class:"text-right text-weight-bold"},{default:e(()=>[i(d(u(I)(j.value.pengajuan)),1)]),_:1}),a(o,{style:{border:"none"}})]),_:1}),v().includes("persetujuan")?(p(),_(D,{key:0,"no-hover":""},{default:e(()=>[a(o,{colspan:"5",style:{border:"none"}}),a(o,{class:"text-right"},{default:e(()=>[i(" Total Disetujui ")]),_:1}),a(o,{class:"text-right text-weight-bold"},{default:e(()=>[i(d(u(I)(j.value.disetujui)),1)]),_:1}),a(o,{style:{border:"none"}})]),_:1})):Q("",!0),v().includes("persetujuan")?(p(),_(D,{key:1,"no-hover":""},{default:e(()=>[a(o,{colspan:"5",style:{border:"none"}}),a(o,{class:"text-right"},{default:e(()=>[i(" Total Ditolak ")]),_:1}),a(o,{class:"text-right text-weight-bold"},{default:e(()=>[i(d(u(I)(j.value.ditolak)),1)]),_:1}),a(o,{style:{border:"none"}})]),_:1})):Q("",!0)]),key:"0"}:void 0]),1032,["rows","visible-columns","fullscreen","filter","selected"]))}}),Va={class:"q-px-md q-pt-md"},Ta={class:"row"},Ia=f("div",{class:"col-4 text-caption"}," Keperluan ",-1),$a={class:"col-8 text-subtitle2"},Ca=f("div",{class:"col-4 text-caption"}," Jenis Transaksi ",-1),xa={class:"col-8 text-subtitle2"},Sa=f("div",{class:"col-4 text-caption"}," Tanggal Pengajuan ",-1),Ua={class:"col-8 text-subtitle2"},qa={class:"q-px-md q-pt-md"},Wa=M({__name:"DetailPengajuanProyekPage",props:{pengajuanDana:{},detailPengajuanDana:{},dokumenPenunjang:{},evaluasi:{},formOptions:{},timeline:{}},setup(C){const x=C,g=[{label:"Keuangan",url:"#"},{label:"Pengajuan Proyek",url:route("pengajuan_dana_proyek")},{label:x.pengajuanDana.nama_proyek,url:"#"}],j=P("uraian"),m=P();return(s,y)=>{const S=sa("in-link");return p(),$(O,null,[a(u(ua),{title:"Pengajuan Proyek"}),a(ea,null,{breadcrumbs:e(()=>[a(aa,{align:"left"},{default:e(()=>[(p(),$(O,null,Z(g,c=>ra(a(na,{key:c.label,label:c.label},null,8,["label"]),[[S,c.url]])),64))]),_:1})]),default:e(()=>{var c,v;return[a(Da,{title:"Pengajuan Proyek","timeline-title":"Timeline Pengajuan Proyek",data:{proyek:s.pengajuanDana,status:s.pengajuanDana.status_pengajuan,timeline:s.timeline}},null,8,["data"]),f("div",Va,[a(R,{flat:"",bordered:"",style:{"max-width":"500px"}},{default:e(()=>[a(ia,null,{default:e(()=>[f("div",Ta,[Ia,f("div",$a," : "+d(s.pengajuanDana.keperluan),1),Ca,f("div",xa," : "+d(s.pengajuanDana.jenis_transaksi),1),Sa,f("div",Ua," : "+d(u(ca)(s.pengajuanDana.tanggal_pengajuan)||"-"),1)])]),_:1})]),_:1})]),f("div",qa,[a(R,{flat:"",bordered:""},{default:e(()=>[a(da,{modelValue:j.value,"onUpdate:modelValue":y[0]||(y[0]=b=>j.value=b),class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:e(()=>[a(K,{"no-caps":"",name:"uraian",label:"Uraian"}),a(K,{"no-caps":"",name:"dokumen",label:"Dokumen Penunjang"})]),_:1},8,["modelValue"]),a(G),a(pa,{modelValue:j.value,"onUpdate:modelValue":y[1]||(y[1]=b=>j.value=b)},{default:e(()=>[a(L,{class:"q-pa-none",name:"uraian"},{default:e(()=>[a(u(Qa),{ref_key:"table",ref:m,rows:s.detailPengajuanDana,data:{pengajuanDana:s.pengajuanDana},"form-options":s.formOptions},null,8,["rows","data","form-options"])]),_:1}),a(L,{class:"q-pa-none",name:"dokumen"},{default:e(()=>[a(u(ma),{rows:s.dokumenPenunjang,data:{model_id:s.pengajuanDana.id_pengajuan_dana,permissions:"create & modify pengajuan dana",status_aktivitas:s.pengajuanDana.status_aktivitas}},null,8,["rows","data"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),u(w)("create & modify pengajuan dana")&&u(B)(s.pengajuanDana)&&s.detailPengajuanDana.length?(p(),_(u(va),{key:0,data:{id_pengajuan_dana:s.pengajuanDana.id_pengajuan_dana}},null,8,["data"])):Q("",!0),u(w)("approve pengajuan dana")&&u(z)(s.pengajuanDana)?(p(),_(u(ha),{key:1,data:{evaluasi:s.evaluasi,approvedPengajuanSaatIni:(c=m.value)==null?void 0:c.approvedPengajuanSaatIni,id_pengajuan_dana:s.pengajuanDana.id_pengajuan_dana,selected_ids_detail_pengajuan_dana:(v=m.value)==null?void 0:v.selectedIds}},null,8,["data"])):Q("",!0)]}),_:1})],64)}}});export{Wa as default};
