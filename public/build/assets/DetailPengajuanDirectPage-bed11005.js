import{i as F,d as w,e as B,f as X,g as Y,Q as E,a as N,h as z,b as aa,_ as ea,c as na}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-b69e3ed2.js";import{d as M,l as S,j as P,o as p,c as _,D as ta,w as e,a,b as r,t as d,u,B as Q,g,h as V,z as la,Q as oa,e as $,k as Z,F as O,f as J,v as G,n as sa,Z as ua,y as R,s as ia,p as ra}from"./app-a9c22e82.js";import{Q as da,a as K,b as pa,c as L,_ as ma}from"./FileDeleteDialog.vue_vue_type_script_setup_true_lang-a192b7ec.js";import{f as ca}from"./ProyekDeleteDialog.vue_vue_type_script_setup_true_lang-29a71a0e.js";import{b as s,a as D,c as _a,d as ga}from"./QTable-0e41b0f2.js";import{Q as fa}from"./datetime-dc60c162.js";import{u as ja}from"./use-quasar-954ed4d5.js";import{a as T,t as I}from"./money-915f7772.js";import{_ as ba,a as ka,b as va,c as ya,d as ha}from"./PengajuanDanaEvaluationDialog.vue_vue_type_script_setup_true_lang-712e6e03.js";import{_ as Da}from"./ModuleTopSection.vue_vue_type_script_setup_true_lang-430fdd1b.js";import"./QImg-b742b038.js";import"./use-dialog-plugin-component-646efe56.js";import"./QFile-41b2f763.js";import"./QForm-332245d0.js";import"./options-4b88285e.js";const wa={class:"q-gutter-sm"},Pa={key:1},Qa=M({__name:"PengajuanDirectItemTable",props:{rows:{},data:{},formOptions:{}},setup(C,{expose:x}){const f=C,j=S(()=>{const l=f.rows.reduce((i,k)=>i+T(k.jumlah_pengajuan),0),t=f.rows.reduce((i,k)=>A.value.includes(k.id_detail_pengajuan_dana)?i+T(k.jumlah_pengajuan):i,0),n=l-t;return{pengajuan:l,disetujui:t,ditolak:n}}),m=ja();function o(){m.dialog({component:ba,componentProps:{pengajuanDana:f.data.pengajuanDana,options:f.formOptions}}).onOk(l=>{m.notify({type:l.type,message:l.message,position:"top"})})}function v(l){m.dialog({component:ka,componentProps:{detailPengajuanDana:l,options:f.formOptions}}).onOk(t=>{m.notify({type:t.type,message:t.message,position:"top"})})}function U(l){m.dialog({component:va,componentProps:{id_detail_pengajuan_dana:l}}).onOk(t=>{m.notify({type:t.type,message:t.message,position:"top"})})}const c=[{name:"index",label:"#",field:"index"},{name:"uraian",label:"Uraian",field:"uraian",align:"left",sortable:!0},{name:"jenis_pembayaran",label:"Jenis Pembayaran",field:"jenis_pembayaran",align:"left",sortable:!0},{name:"bank",label:"Bank",field:"nama_bank",align:"left",sortable:!0},{name:"rekening",label:"Rekening",field:"nomor_rekening",align:"left",sortable:!0},{name:"jumlah",label:"Jumlah Pengajuan",field:"jumlah_pengajuan",align:"right",sortable:!0},{name:"persetujuan",label:"Approval",field:"",align:"left"},{name:"actions",label:"Actions",field:"",align:"left"}],y=()=>{const l=[];return w("approve pengajuan dana")&&z(f.data.pengajuanDana)?c.map(t=>l.push(t.name)):c.map(t=>{if(t.name!=="persetujuan")return l.push(t.name)}),l},b=P(!1);function H(){b.value=!b.value}const q=P(""),h=P([]),A=S(()=>{const l=[];return h.value&&h.value.map(t=>l.push(t.id_detail_pengajuan_dana)),l}),W=S(()=>h.value?h.value.reduce((t,n)=>{const i=t.find(k=>k.id_detail_rap===n.id_detail_rap);return i!=null?i.jumlah_pengajuan+=T(n.jumlah_pengajuan):t.push({id_detail_rap:n.id_detail_rap,jumlah_pengajuan:T(n.jumlah_pengajuan)}),t},[]):[]);return x({selectedIds:A,approvedPengajuanSaatIni:W}),(l,t)=>(p(),_(_a,{flat:"",bordered:"","row-key":"id_detail_pengajuan_dana",rows:l.rows,columns:c,"visible-columns":y(),"rows-per-page-options":[10,15,20,25,50,0],fullscreen:b.value,filter:q.value,selection:"multiple",selected:h.value,"onUpdate:selected":t[1]||(t[1]=n=>h.value=n),class:"no-border"},ta({"top-left":e(()=>[g("div",wa,[u(F)()||u(w)("create & modify pengajuan dana")&&u(B)(l.data.pengajuanDana)?(p(),_(V,{key:0,"no-caps":"",label:"Tambah Uraian",icon:"add",color:"primary",onClick:o})):Q("",!0)])]),"top-right":e(()=>[a(oa,{dense:"",debounce:"300",modelValue:q.value,"onUpdate:modelValue":t[0]||(t[0]=n=>q.value=n),placeholder:"Search"},{append:e(()=>[a(la,{name:"search"})]),_:1},8,["modelValue"]),a(V,{flat:"",dense:"",icon:b.value?"fullscreen_exit":"fullscreen",onClick:H,class:"q-ml-md"},null,8,["icon"])]),header:e(n=>[a(D,{props:n},{default:e(()=>[(p(!0),$(O,null,Z(n.cols,i=>(p(),_(ga,{key:i.name,props:n,style:{"font-weight":"bold"}},{default:e(()=>[i.name==="persetujuan"?(p(),_(J,{key:0,modelValue:n.selected,"onUpdate:modelValue":k=>n.selected=k,label:"Approval"},null,8,["modelValue","onUpdate:modelValue"])):(p(),$("span",Pa,d(i.label),1))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:e(n=>[a(D,{props:n},{default:e(()=>[a(s,{key:"index",props:n},{default:e(()=>[r(d(++n.rowIndex),1)]),_:2},1032,["props"]),a(s,{key:"uraian",props:n},{default:e(()=>[r(d(n.row.uraian),1)]),_:2},1032,["props"]),a(s,{key:"jenis_pembayaran",props:n},{default:e(()=>[r(d(n.row.jenis_pembayaran),1)]),_:2},1032,["props"]),a(s,{key:"bank",props:n},{default:e(()=>[r(d(n.row.nama_bank),1)]),_:2},1032,["props"]),a(s,{key:"rekening",props:n},{default:e(()=>[r(d(n.row.nomor_rekening)+" - "+d(n.row.nama_rekening),1)]),_:2},1032,["props"]),a(s,{key:"jumlah",props:n},{default:e(()=>[r(d(u(I)(n.row.jumlah_pengajuan)),1)]),_:2},1032,["props"]),a(s,{key:"persetujuan",props:n},{default:e(()=>[a(J,{modelValue:n.selected,"onUpdate:modelValue":i=>n.selected=i},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"]),a(s,{key:"actions",props:n},{default:e(()=>[u(F)()||u(w)("create & modify pengajuan dana")&&u(B)(l.data.pengajuanDana)?(p(),_(V,{key:0,dense:"",flat:"",color:"blue-grey",icon:"more_vert"},{default:e(()=>[a(X,{"auto-close":"","transition-show":"scale","transition-hide":"scale"},{default:e(()=>[a(Y,{dense:"",style:{"min-width":"100px"}},{default:e(()=>[a(E,{clickable:""},{default:e(()=>[a(N,{onClick:i=>v(n.row)},{default:e(()=>[r(" Edit ")]),_:2},1032,["onClick"])]),_:2},1024),a(G),a(E,{clickable:""},{default:e(()=>[a(N,{class:"text-red",onClick:i=>U(n.row.id_detail_pengajuan_dana)},{default:e(()=>[r(" Delete ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):(p(),_(V,{key:1,dense:"",flat:"",color:"grey-6",icon:"block"},{default:e(()=>[a(fa,null,{default:e(()=>[r("Required permission")]),_:1})]),_:1}))]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:2},[l.rows.length?{name:"bottom-row",fn:e(()=>[a(D,{"no-hover":""},{default:e(()=>[a(s,{colspan:"5",style:{border:"none"}}),a(s,{class:"text-right"},{default:e(()=>[r(" Total Pengajuan ")]),_:1}),a(s,{class:"text-right text-weight-bold"},{default:e(()=>[r(d(u(I)(j.value.pengajuan)),1)]),_:1}),a(s,{style:{border:"none"}})]),_:1}),y().includes("persetujuan")?(p(),_(D,{key:0,"no-hover":""},{default:e(()=>[a(s,{colspan:"5",style:{border:"none"}}),a(s,{class:"text-right"},{default:e(()=>[r(" Total Disetujui ")]),_:1}),a(s,{class:"text-right text-weight-bold"},{default:e(()=>[r(d(u(I)(j.value.disetujui)),1)]),_:1}),a(s,{style:{border:"none"}})]),_:1})):Q("",!0),y().includes("persetujuan")?(p(),_(D,{key:1,"no-hover":""},{default:e(()=>[a(s,{colspan:"5",style:{border:"none"}}),a(s,{class:"text-right"},{default:e(()=>[r(" Total Ditolak ")]),_:1}),a(s,{class:"text-right text-weight-bold"},{default:e(()=>[r(d(u(I)(j.value.ditolak)),1)]),_:1}),a(s,{style:{border:"none"}})]),_:1})):Q("",!0)]),key:"0"}:void 0]),1032,["rows","visible-columns","fullscreen","filter","selected"]))}}),Va={class:"q-px-md q-pt-md"},Ta={class:"row"},Ia=g("div",{class:"col-4 text-caption"}," Keperluan ",-1),$a={class:"col-8 text-subtitle2"},Ca=g("div",{class:"col-4 text-caption"}," Jenis Transaksi ",-1),xa={class:"col-8 text-subtitle2"},Ua=g("div",{class:"col-4 text-caption"}," Tanggal Pengajuan ",-1),qa={class:"col-8 text-subtitle2"},Sa={class:"q-px-md q-pt-md"},Wa=M({__name:"DetailPengajuanDirectPage",props:{pengajuanDana:{},detailPengajuanDana:{},dokumenPenunjang:{},evaluasi:{},formOptions:{},timeline:{}},setup(C){const x=C,f=[{label:"Keuangan",url:"#"},{label:"Pengajuan Direct",url:route("pengajuan_dana_direct")},{label:x.pengajuanDana.nama_proyek,url:"#"}],j=P("uraian"),m=P();return(o,v)=>{const U=sa("in-link");return p(),$(O,null,[a(u(ua),{title:"Pengajuan Direct"}),a(ea,null,{breadcrumbs:e(()=>[a(aa,{align:"left"},{default:e(()=>[(p(),$(O,null,Z(f,c=>ra(a(na,{key:c.label,label:c.label},null,8,["label"]),[[U,c.url]])),64))]),_:1})]),default:e(()=>{var c,y;return[a(Da,{title:"Pengajuan Direct","timeline-title":"Timeline Pengajuan Direct",data:{proyek:o.pengajuanDana,status:o.pengajuanDana.status_pengajuan,timeline:o.timeline}},null,8,["data"]),g("div",Va,[a(R,{flat:"",bordered:"",style:{"max-width":"500px"}},{default:e(()=>[a(ia,null,{default:e(()=>[g("div",Ta,[Ia,g("div",$a," : "+d(o.pengajuanDana.keperluan),1),Ca,g("div",xa," : "+d(o.pengajuanDana.jenis_transaksi),1),Ua,g("div",qa," : "+d(u(ca)(o.pengajuanDana.tanggal_pengajuan)||"-"),1)])]),_:1})]),_:1})]),g("div",Sa,[a(R,{flat:"",bordered:""},{default:e(()=>[a(da,{modelValue:j.value,"onUpdate:modelValue":v[0]||(v[0]=b=>j.value=b),class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:e(()=>[a(K,{"no-caps":"",name:"uraian",label:"Uraian"}),a(K,{"no-caps":"",name:"dokumen",label:"Dokumen Penunjang"})]),_:1},8,["modelValue"]),a(G),a(pa,{modelValue:j.value,"onUpdate:modelValue":v[1]||(v[1]=b=>j.value=b)},{default:e(()=>[a(L,{class:"q-pa-none",name:"uraian"},{default:e(()=>[a(u(Qa),{ref_key:"table",ref:m,rows:o.detailPengajuanDana,data:{pengajuanDana:o.pengajuanDana},"form-options":o.formOptions},null,8,["rows","data","form-options"])]),_:1}),a(L,{class:"q-pa-none",name:"dokumen"},{default:e(()=>[a(u(ma),{rows:o.dokumenPenunjang,data:{model_id:o.pengajuanDana.id_pengajuan_dana,permissions:"create & modify pengajuan dana",status_aktivitas:o.pengajuanDana.status_aktivitas}},null,8,["rows","data"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),u(w)("create & modify pengajuan dana")&&u(B)(o.pengajuanDana)&&o.detailPengajuanDana.length?(p(),_(u(ya),{key:0,data:{id_pengajuan_dana:o.pengajuanDana.id_pengajuan_dana}},null,8,["data"])):Q("",!0),u(w)("approve pengajuan dana")&&u(z)(o.pengajuanDana)?(p(),_(u(ha),{key:1,data:{evaluasi:o.evaluasi,approvedPengajuanSaatIni:(c=m.value)==null?void 0:c.approvedPengajuanSaatIni,id_pengajuan_dana:o.pengajuanDana.id_pengajuan_dana,selected_ids_detail_pengajuan_dana:(y=m.value)==null?void 0:y.selectedIds}},null,8,["data"])):Q("",!0)]}),_:1})],64)}}});export{Wa as default};
