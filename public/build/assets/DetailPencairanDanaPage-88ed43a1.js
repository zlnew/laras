import{i as W,d as $,e as H,b as X,h as Y,_ as aa,c as ea}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-12264d28.js";import{d as T,l as J,j as q,o as b,c as P,C as na,w as e,a,b as d,t as c,u as r,y as ta,Q as A,h as w,e as S,k as z,F as B,i as U,O as ra,T as R,p as la,q as F,s as I,g,v as oa,A as E,x as O,E as ia,m as sa,Z as ua,n as da}from"./app-98415438.js";import{Q as ca,a as M,b as ma,c as N,_ as pa}from"./FileDeleteDialog.vue_vue_type_script_setup_true_lang-f5ae419d.js";import{f as _a}from"./ProyekDeleteDialog.vue_vue_type_script_setup_true_lang-13d5be79.js";import{b as o,a as x,c as fa,d as ba}from"./QTable-a233578c.js";import{Q as Z}from"./QTooltip-e1570a44.js";import{Q as ya}from"./QPopupEdit-6ef8816e.js";import{u as L}from"./use-quasar-52eeb4b4.js";import{a as k,t as v,s as ga}from"./money-915f7772.js";import{u as K,Q as ha}from"./use-dialog-plugin-component-530071f9.js";import{Q as ka}from"./QForm-90bf62d3.js";import{Q as G,_ as va}from"./ModuleTopSection.vue_vue_type_script_setup_true_lang-df930ee5.js";import{Q as V,a as ja}from"./QFab-59503150.js";import"./QImg-24af00d1.js";import"./QFile-90a5ce7f.js";import"./options-4b88285e.js";const Da={key:0,class:"text-primary",style:{cursor:"pointer"}},wa={key:1},Pa=T({__name:"PencairanDanaItemTable",props:{rows:{},data:{}},setup(j){const p=j,m=J(()=>p.rows.map(n=>{n.pembayaran_lalu="0",n.pembayaran_saat_ini="0",p.data.detailPencairanDana&&p.data.detailPencairanDana.map(s=>{s.id_detail_pengajuan_dana==n.id_detail_pengajuan_dana&&(s.status_pembayaran==="100"&&(n.pembayaran_saat_ini=(k(n.pembayaran_saat_ini)+k(s.jumlah_pencairan)).toString()),s.status_pembayaran==="400"&&(n.pembayaran_lalu=(k(n.pembayaran_lalu)+k(s.jumlah_pencairan)).toString()))});const f=k(n.pembayaran_lalu)+k(n.pembayaran_saat_ini),t=k(n.jumlah_pengajuan)-f;return{...n,belum_dibayarkan:t}})),u=J(()=>{const n=p.rows.reduce((h,Q)=>h+k(Q.jumlah_pengajuan),0),f=m.value.reduce((h,Q)=>h+k(Q.pembayaran_lalu),0),t=m.value.reduce((h,Q)=>h+k(Q.pembayaran_saat_ini),0),s=m.value.reduce((h,Q)=>h+Q.belum_dibayarkan,0);return{pengajuan:n,pembayaranLalu:f,pembayaranSaatIni:t,belumDibayarkan:s}}),l=L(),y=[{name:"index",label:"#",field:"index"},{name:"uraian",label:"Uraian",field:"uraian",align:"left",sortable:!0},{name:"pos",label:"POS",field:"pos",align:"left",sortable:!0},{name:"jenis_pembayaran",label:"Jenis Pembayaran",field:"jenis_pembayaran",align:"left",sortable:!0},{name:"bank",label:"Bank",field:"nama_bank",align:"left",sortable:!0},{name:"rekening",label:"Rekening",field:"nomor_rekening",align:"left",sortable:!0},{name:"jumlah",label:"Jumlah Pengajuan",field:"jumlah_pengajuan",align:"right",sortable:!0},{name:"pembayaran_lalu",label:"Pembayaran Lalu",field:"",align:"right",sortable:!0},{name:"pembayaran_saat_ini",label:"Pembayaran Saat Ini",field:"",align:"right",sortable:!0},{name:"belum_dibayarkan",label:"Belum Dibayarkan",field:"",align:"right",sortable:!0}],_=q(!1);function i(){_.value=!_.value}const C=q("");function D(n,f){const t={id_detail_pengajuan_dana:f,jumlah_pencairan:k(n)};ra.post(route("detail_pencairan_dana.store",p.data.pencairanDana.id_pencairan_dana),t,{onSuccess:s=>{l.notify({type:"positive",message:s.props.flash.success,position:"top"})}})}return(n,f)=>(b(),P(fa,{flat:"",bordered:"","row-key":"id_detail_pengajuan_dana",title:"Pencairan Dana",rows:m.value,columns:y,"rows-per-page-options":[10,15,20,25,50,0],fullscreen:_.value,filter:C.value,class:"no-border"},na({"top-right":e(()=>[a(A,{dense:"",debounce:"300",modelValue:C.value,"onUpdate:modelValue":f[0]||(f[0]=t=>C.value=t),placeholder:"Search"},{append:e(()=>[a(ta,{name:"search"})]),_:1},8,["modelValue"]),a(w,{flat:"",dense:"",icon:_.value?"fullscreen_exit":"fullscreen",onClick:i,class:"q-ml-md"},null,8,["icon"])]),header:e(t=>[a(x,{props:t},{default:e(()=>[(b(!0),S(B,null,z(t.cols,s=>(b(),P(ba,{key:s.name,props:t,style:{"font-weight":"bold"}},{default:e(()=>[d(c(s.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:e(t=>[a(x,{props:t},{default:e(()=>[a(o,{key:"index",props:t},{default:e(()=>[d(c(++t.rowIndex),1)]),_:2},1032,["props"]),a(o,{key:"uraian",props:t},{default:e(()=>[d(c(t.row.uraian),1)]),_:2},1032,["props"]),a(o,{key:"pos",props:t},{default:e(()=>[d(c(t.row.pos),1)]),_:2},1032,["props"]),a(o,{key:"jenis_pembayaran",props:t},{default:e(()=>[d(c(t.row.jenis_pembayaran),1)]),_:2},1032,["props"]),a(o,{key:"bank",props:t},{default:e(()=>[d(c(t.row.nama_bank),1)]),_:2},1032,["props"]),a(o,{key:"rekening",props:t},{default:e(()=>[d(c(t.row.nomor_rekening)+" - "+c(t.row.nama_rekening),1)]),_:2},1032,["props"]),a(o,{key:"jumlah",props:t},{default:e(()=>[d(c(r(v)(t.row.jumlah_pengajuan)),1)]),_:2},1032,["props"]),a(o,{key:"pembayaran_lalu",props:t},{default:e(()=>[d(c(r(v)(t.row.pembayaran_lalu)),1)]),_:2},1032,["props"]),a(o,{key:"pembayaran_saat_ini",props:t},{default:e(()=>[r(W)()||r($)("create & modify pencairan dana")&&r(H)(n.data.pencairanDana)?(b(),S("div",Da,[d(c(r(v)(t.row.pembayaran_saat_ini))+" ",1),a(Z,null,{default:e(()=>[d("Click to edit")]),_:1}),a(ya,{modelValue:t.row.pembayaran_saat_ini,"onUpdate:modelValue":s=>t.row.pembayaran_saat_ini=s,modelModifiers:{number:!0},title:"Pembayaran Saat Ini"},{default:e(s=>[a(A,{dense:"",autofocus:"",modelValue:s.value,"onUpdate:modelValue":h=>s.value=h,hint:r(v)(s.value)},{after:e(()=>[a(w,{flat:"",dense:"",color:"negative",icon:"cancel",onClick:U(s.cancel,["stop","prevent"])},null,8,["onClick"]),a(w,{flat:"",dense:"",color:"positive",icon:"check_circle",disable:s.validate(s.value)===!1||s.initialValue===s.value,onClick:[U(h=>D(s.value,t.row.id_detail_pengajuan_dana),["stop","prevent"]),s.set]},null,8,["disable","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","hint"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])):(b(),S("div",wa,c(r(v)(t.row.pembayaran_saat_ini)),1))]),_:2},1032,["props"]),a(o,{key:"belum_dibayarkan",props:t},{default:e(()=>[d(c(r(v)(t.row.belum_dibayarkan)),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:2},[m.value.length?{name:"bottom-row",fn:e(()=>[a(x,{"no-hover":""},{default:e(()=>[a(o,{colspan:"5",style:{border:"none"}}),a(o,{class:"text-right"},{default:e(()=>[d(" Total Pengajuan ")]),_:1}),a(o,{class:"text-right text-weight-bold"},{default:e(()=>[d(c(r(v)(u.value.pengajuan)),1)]),_:1}),a(o,{style:{border:"none"}})]),_:1}),a(x,{"no-hover":""},{default:e(()=>[a(o,{colspan:"5",style:{border:"none"}}),a(o,{class:"text-right"},{default:e(()=>[d(" Total Pembayaran Lalu ")]),_:1}),a(o,{class:"text-right text-weight-bold"},{default:e(()=>[d(c(r(v)(u.value.pembayaranLalu)),1)]),_:1}),a(o,{style:{border:"none"}})]),_:1}),a(x,{"no-hover":""},{default:e(()=>[a(o,{colspan:"5",style:{border:"none"}}),a(o,{class:"text-right"},{default:e(()=>[d(" Total Pembayaran Saat Ini ")]),_:1}),a(o,{class:"text-right text-weight-bold"},{default:e(()=>[d(c(r(v)(u.value.pembayaranSaatIni)),1)]),_:1}),a(o,{style:{border:"none"}})]),_:1}),a(x,{"no-hover":""},{default:e(()=>[a(o,{colspan:"5",style:{border:"none"}}),a(o,{class:"text-right"},{default:e(()=>[d(" Total Belum Dibayarkan ")]),_:1}),a(o,{class:"text-right text-weight-bold"},{default:e(()=>[d(c(r(v)(u.value.belumDibayarkan)),1)]),_:1}),a(o,{style:{border:"none"}})]),_:1})]),key:"0"}:void 0]),1032,["rows","fullscreen","filter"]))}}),Ca=g("div",{class:"text-h6"},"Pencairan Dana",-1),Qa={class:"q-gutter-md"};[...K.emits];const xa=T({__name:"PencairanDanaSubmissionForm",props:{data:{}},setup(j){const p=j,m=L(),u=R({catatan:""});function l(){u.post(route("pencairan_dana.submit",p.data.id_pencairan_dana),{onSuccess:_=>{m.notify({type:"positive",message:_.props.flash.success,position:"top"})}})}function y(){m.dialog({title:"Submission Confirmation",message:"Are you sure want to submit this data?",prompt:{outlined:!0,autogrow:!0,model:"",type:"text",placeholder:"Tambahkan Catatan"},color:"primary",cancel:!0,persistent:!0}).onOk(_=>{u.catatan=_,l()})}return(_,i)=>(b(),P(G,{position:"bottom-right",offset:[18,18]},{default:e(()=>[a(w,{rounded:"",color:"primary",label:"Submit","icon-right":"check",onClick:y,class:"q-pa-md"},{default:e(()=>[a(Z,null,{default:e(()=>[d("Click to submit")]),_:1})]),_:1})]),_:1}))}}),Sa=T({__name:"PencairanDanaApprovalForm",props:{data:{}},setup(j){const p=j,m=L(),u=R({catatan:""});function l(){u.post(route("pencairan_dana.confirm",p.data.id_pencairan_dana),{onSuccess:n=>{m.notify({type:"positive",message:n.props.flash.success,position:"top"})}})}function y(){u.transform(n=>({...n,bertahap:!0})).post(route("pencairan_dana.confirm",p.data.id_pencairan_dana),{onSuccess:n=>{m.notify({type:"positive",message:n.props.flash.success,position:"top"})}})}function _(){u.post(route("pencairan_dana.reject",p.data.id_pencairan_dana),{onSuccess:n=>{m.notify({type:"positive",message:n.props.flash.success,position:"top"})}})}function i(){m.dialog({title:"Receipt Confirmation",message:"Are you sure want to perform this action?",prompt:{outlined:!0,autogrow:!0,model:"",type:"text",placeholder:"Tambahkan Catatan"},color:"positive",cancel:!0,persistent:!0}).onOk(n=>{u.catatan=n,l()})}function C(){m.dialog({title:"Receipt Confirmation",message:"Are you sure want to perform this action?",prompt:{outlined:!0,autogrow:!0,model:"",type:"text",placeholder:"Tambahkan Catatan"},color:"secondary",cancel:!0,persistent:!0}).onOk(n=>{u.catatan=n,y()})}function D(){m.dialog({title:"Rejection Confirmation",message:"Are you sure want to perform this action?",prompt:{outlined:!0,autogrow:!0,model:"",type:"text",placeholder:"Tambahkan Catatan"},color:"negative",cancel:!0,persistent:!0}).onOk(n=>{u.catatan=n,_()})}return(n,f)=>(b(),P(G,{position:"bottom-right",offset:[18,18]},{default:e(()=>[a(ja,{color:"primary",icon:"keyboard_arrow_left",direction:"left"},{label:e(({opened:t})=>[g("div",{class:ia({"example-fab-animate--hover":t!==!0})},c(t!==!0?"Konfirmasi Penerimaan":"Close"),3)]),default:e(()=>[a(V,{color:"green",label:"Terima Lunas",icon:"check",onClick:i}),a(V,{color:"secondary",label:"Terima Bertahap",icon:"check",onClick:C}),a(V,{color:"red",label:"Tolak",icon:"clear",onClick:D})]),_:1})]),_:1}))}}),Ta={class:"q-px-md q-pt-md"},Va={class:"row"},$a=g("div",{class:"col-4 text-caption"}," Keperluan ",-1),qa={class:"col-8 text-subtitle2"},Aa=g("div",{class:"col-4 text-caption"}," Jenis Transaksi ",-1),Ba={class:"col-8 text-subtitle2"},Ua=g("div",{class:"col-4 text-caption"}," Tanggal Pengajuan ",-1),Fa={class:"col-8 text-subtitle2"},Ia={class:"q-px-md q-pt-md"},ee=T({__name:"DetailPencairanDanaPage",props:{pencairanDana:{},pengajuanDana:{},detailPencairanDana:{},detailPengajuanDana:{},dokumenPenunjang:{},timeline:{}},setup(j){const p=j,m=[{label:"Keuangan",url:"#"},{label:"Pencairan Dana",url:route("pencairan_dana")},{label:p.pencairanDana.nama_proyek,url:"#"}],u=q("uraian");return(l,y)=>{const _=sa("in-link");return b(),S(B,null,[a(r(ua),{title:"Pencairan Dana"}),a(aa,null,{breadcrumbs:e(()=>[a(X,{align:"left"},{default:e(()=>[(b(),S(B,null,z(m,i=>da(a(ea,{key:i.label,label:i.label},null,8,["label"]),[[_,i.url]])),64))]),_:1})]),default:e(()=>[a(va,{title:"Pencairan Dana","timeline-title":"Timeline Pencairan Dana",data:{proyek:l.pencairanDana,status:l.pencairanDana.status_pencairan,timeline:l.timeline}},null,8,["data"]),g("div",Ta,[a(O,{flat:"",bordered:"",style:{"max-width":"500px"}},{default:e(()=>[a(F,null,{default:e(()=>[g("div",Va,[$a,g("div",qa," : "+c(l.pengajuanDana.keperluan),1),Aa,g("div",Ba," : "+c(l.pengajuanDana.jenis_transaksi),1),Ua,g("div",Fa," : "+c(r(_a)(l.pengajuanDana.tanggal_pengajuan)||"-"),1)])]),_:1})]),_:1})]),g("div",Ia,[a(O,{flat:"",bordered:""},{default:e(()=>[a(ca,{modelValue:u.value,"onUpdate:modelValue":y[0]||(y[0]=i=>u.value=i),class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:e(()=>[a(M,{"no-caps":"",name:"uraian",label:"Uraian"}),a(M,{"no-caps":"",name:"dokumen",label:"Dokumen Penunjang"})]),_:1},8,["modelValue"]),a(I),a(ma,{modelValue:u.value,"onUpdate:modelValue":y[1]||(y[1]=i=>u.value=i)},{default:e(()=>[a(N,{class:"q-pa-none",name:"uraian"},{default:e(()=>[a(r(Pa),{rows:l.detailPengajuanDana,data:{pencairanDana:l.pencairanDana,pengajuanDana:l.pengajuanDana,detailPencairanDana:l.detailPencairanDana}},null,8,["rows","data"])]),_:1}),a(N,{class:"q-pa-none",name:"dokumen"},{default:e(()=>[a(r(pa),{rows:l.dokumenPenunjang,data:{model_id:l.pencairanDana.id_pencairan_dana,permissions:"create & modify pencairan dana",status_aktivitas:l.pencairanDana.status_aktivitas}},null,8,["rows","data"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),r($)("create & modify pencairan dana")&&r(H)(l.pencairanDana)&&l.detailPencairanDana.length?(b(),P(r(xa),{key:0,data:{id_pencairan_dana:l.pencairanDana.id_pencairan_dana}},null,8,["data"])):E("",!0),r($)("confirm pencairan dana")&&r(Y)(l.pencairanDana)?(b(),P(r(Sa),{key:1,data:{id_pencairan_dana:l.pencairanDana.id_pencairan_dana}},null,8,["data"])):E("",!0)]),_:1})],64)}}});export{ee as default};
