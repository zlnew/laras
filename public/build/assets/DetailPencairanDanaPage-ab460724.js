import{i as G,d as $,e as N,b as W,h as X,_ as Y,c as aa}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-b69e3ed2.js";import{d as T,l as K,j as q,o as b,c as w,D as ea,w as e,a,b as u,t as d,u as r,z as na,Q as A,h as x,e as S,k as H,F as B,E as ta,O as ra,T as O,q as la,s as U,v as F,i as oa,g,x as ia,B as I,y as E,H as sa,n as ua,Z as da,p as ca}from"./app-a9c22e82.js";import{Q as ma,a as L,b as pa,c as J,_ as _a}from"./FileDeleteDialog.vue_vue_type_script_setup_true_lang-a192b7ec.js";import{f as fa}from"./ProyekDeleteDialog.vue_vue_type_script_setup_true_lang-29a71a0e.js";import{b as o,a as C,c as ba,d as ya}from"./QTable-0e41b0f2.js";import{Q as z}from"./datetime-dc60c162.js";import{Q as ga}from"./QPopupEdit-4a5cd368.js";import{u as R}from"./use-quasar-954ed4d5.js";import{a as h,t as k,s as ha}from"./money-915f7772.js";import{u as M,Q as ka}from"./use-dialog-plugin-component-646efe56.js";import{Q as va}from"./QForm-332245d0.js";import{Q as Z,_ as ja}from"./ModuleTopSection.vue_vue_type_script_setup_true_lang-430fdd1b.js";import{Q as V,a as Da}from"./QFab-734dfc72.js";import"./QImg-b742b038.js";import"./QFile-41b2f763.js";import"./options-4b88285e.js";const wa={key:0,class:"text-primary",style:{cursor:"pointer"}},Pa={key:1},Qa=T({__name:"PencairanDanaItemTable",props:{rows:{},data:{}},setup(j){const p=j,m=K(()=>p.rows.map(n=>{n.pembayaran_lalu="0",n.pembayaran_saat_ini="0",p.data.detailPencairanDana&&p.data.detailPencairanDana.map(c=>{c.id_detail_pengajuan_dana==n.id_detail_pengajuan_dana&&(c.status_pembayaran==="100"&&(n.pembayaran_saat_ini=(h(n.pembayaran_saat_ini)+h(c.jumlah_pencairan)).toString()),c.status_pembayaran==="400"&&(n.pembayaran_lalu=(h(n.pembayaran_lalu)+h(c.jumlah_pencairan)).toString()))});const f=h(n.pembayaran_lalu)+h(n.pembayaran_saat_ini),t=h(n.jumlah_pengajuan)-f;return{...n,belum_dibayarkan:t}})),s=K(()=>{const n=p.rows.reduce((v,Q)=>v+h(Q.jumlah_pengajuan),0),f=m.value.reduce((v,Q)=>v+h(Q.pembayaran_lalu),0),t=m.value.reduce((v,Q)=>v+h(Q.pembayaran_saat_ini),0),c=m.value.reduce((v,Q)=>v+Q.belum_dibayarkan,0);return{pengajuan:n,pembayaranLalu:f,pembayaranSaatIni:t,belumDibayarkan:c}}),l=R(),y=[{name:"index",label:"#",field:"index"},{name:"uraian",label:"Uraian",field:"uraian",align:"left",sortable:!0},{name:"pos",label:"POS",field:"pos",align:"left",sortable:!0},{name:"jenis_pembayaran",label:"Jenis Pembayaran",field:"jenis_pembayaran",align:"left",sortable:!0},{name:"bank",label:"Bank",field:"nama_bank",align:"left",sortable:!0},{name:"rekening",label:"Rekening",field:"nomor_rekening",align:"left",sortable:!0},{name:"jumlah",label:"Jumlah Pengajuan",field:"jumlah_pengajuan",align:"right",sortable:!0},{name:"pembayaran_lalu",label:"Pembayaran Lalu",field:"",align:"right",sortable:!0},{name:"pembayaran_saat_ini",label:"Pembayaran Saat Ini",field:"",align:"right",sortable:!0},{name:"belum_dibayarkan",label:"Belum Dibayarkan",field:"",align:"right",sortable:!0}],_=q(!1);function i(){_.value=!_.value}const P=q("");function D(n,f){const t={id_detail_pengajuan_dana:f,jumlah_pencairan:h(n)};ra.post(route("detail_pencairan_dana.store",p.data.pencairanDana.id_pencairan_dana),t,{onSuccess:c=>{l.notify({type:"positive",message:c.props.flash.success,position:"top"})}})}return(n,f)=>(b(),w(ba,{flat:"",bordered:"","row-key":"id_detail_pengajuan_dana",title:"Pencairan Dana",rows:m.value,columns:y,"rows-per-page-options":[10,15,20,25,50,0],fullscreen:_.value,filter:P.value,class:"no-border"},ea({"top-right":e(()=>[a(A,{dense:"",debounce:"300",modelValue:P.value,"onUpdate:modelValue":f[0]||(f[0]=t=>P.value=t),placeholder:"Search"},{append:e(()=>[a(na,{name:"search"})]),_:1},8,["modelValue"]),a(x,{flat:"",dense:"",icon:_.value?"fullscreen_exit":"fullscreen",onClick:i,class:"q-ml-md"},null,8,["icon"])]),header:e(t=>[a(C,{props:t},{default:e(()=>[(b(!0),S(B,null,H(t.cols,c=>(b(),w(ya,{key:c.name,props:t,style:{"font-weight":"bold"}},{default:e(()=>[u(d(c.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:e(t=>[a(C,{props:t},{default:e(()=>[a(o,{key:"index",props:t},{default:e(()=>[u(d(++t.rowIndex),1)]),_:2},1032,["props"]),a(o,{key:"uraian",props:t},{default:e(()=>[u(d(t.row.uraian),1)]),_:2},1032,["props"]),a(o,{key:"pos",props:t},{default:e(()=>[u(d(t.row.pos),1)]),_:2},1032,["props"]),a(o,{key:"jenis_pembayaran",props:t},{default:e(()=>[u(d(t.row.jenis_pembayaran),1)]),_:2},1032,["props"]),a(o,{key:"bank",props:t},{default:e(()=>[u(d(t.row.nama_bank),1)]),_:2},1032,["props"]),a(o,{key:"rekening",props:t},{default:e(()=>[u(d(t.row.nomor_rekening)+" - "+d(t.row.nama_rekening),1)]),_:2},1032,["props"]),a(o,{key:"jumlah",props:t},{default:e(()=>[u(d(r(k)(t.row.jumlah_pengajuan)),1)]),_:2},1032,["props"]),a(o,{key:"pembayaran_lalu",props:t},{default:e(()=>[u(d(r(k)(t.row.pembayaran_lalu)),1)]),_:2},1032,["props"]),a(o,{key:"pembayaran_saat_ini",props:t},{default:e(()=>[r(G)()||r($)("create & modify pencairan dana")&&r(N)(n.data.pencairanDana)?(b(),S("div",wa,[u(d(r(k)(t.row.pembayaran_saat_ini))+" ",1),a(z,null,{default:e(()=>[u("Click to edit")]),_:1}),a(ga,{modelValue:t.row.pembayaran_saat_ini,"onUpdate:modelValue":c=>t.row.pembayaran_saat_ini=c,modelModifiers:{number:!0},title:"Pembayaran Saat Ini"},{default:e(c=>[a(A,{flat:"",dense:"",autofocus:"",modelValue:c.value,"onUpdate:modelValue":v=>c.value=v,hint:r(k)(c.value),onKeyup:ta(()=>{D(c.value,t.row.id_detail_pengajuan_dana),c.set()},["enter"])},null,8,["modelValue","onUpdate:modelValue","hint","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])):(b(),S("div",Pa,d(r(k)(t.row.pembayaran_saat_ini)),1))]),_:2},1032,["props"]),a(o,{key:"belum_dibayarkan",props:t},{default:e(()=>[u(d(r(k)(t.row.belum_dibayarkan)),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:2},[m.value.length?{name:"bottom-row",fn:e(()=>[a(C,{"no-hover":""},{default:e(()=>[a(o,{colspan:"5",style:{border:"none"}}),a(o,{class:"text-right"},{default:e(()=>[u(" Total Pengajuan ")]),_:1}),a(o,{class:"text-right text-weight-bold"},{default:e(()=>[u(d(r(k)(s.value.pengajuan)),1)]),_:1}),a(o,{style:{border:"none"}})]),_:1}),a(C,{"no-hover":""},{default:e(()=>[a(o,{colspan:"5",style:{border:"none"}}),a(o,{class:"text-right"},{default:e(()=>[u(" Total Pembayaran Lalu ")]),_:1}),a(o,{class:"text-right text-weight-bold"},{default:e(()=>[u(d(r(k)(s.value.pembayaranLalu)),1)]),_:1}),a(o,{style:{border:"none"}})]),_:1}),a(C,{"no-hover":""},{default:e(()=>[a(o,{colspan:"5",style:{border:"none"}}),a(o,{class:"text-right"},{default:e(()=>[u(" Total Pembayaran Saat Ini ")]),_:1}),a(o,{class:"text-right text-weight-bold"},{default:e(()=>[u(d(r(k)(s.value.pembayaranSaatIni)),1)]),_:1}),a(o,{style:{border:"none"}})]),_:1}),a(C,{"no-hover":""},{default:e(()=>[a(o,{colspan:"5",style:{border:"none"}}),a(o,{class:"text-right"},{default:e(()=>[u(" Total Belum Dibayarkan ")]),_:1}),a(o,{class:"text-right text-weight-bold"},{default:e(()=>[u(d(r(k)(s.value.belumDibayarkan)),1)]),_:1}),a(o,{style:{border:"none"}})]),_:1})]),key:"0"}:void 0]),1032,["rows","fullscreen","filter"]))}}),Ca=g("div",{class:"text-h6"},"Pencairan Dana",-1),xa={class:"q-gutter-md"};[...M.emits];const Sa=T({__name:"PencairanDanaSubmissionForm",props:{data:{}},setup(j){const p=j,m=R(),s=O({catatan:""});function l(){s.post(route("pencairan_dana.submit",p.data.id_pencairan_dana),{onSuccess:_=>{m.notify({type:"positive",message:_.props.flash.success,position:"top"})}})}function y(){m.dialog({title:"Submission Confirmation",message:"Are you sure want to submit this data?",prompt:{outlined:!0,autogrow:!0,model:"",type:"text",placeholder:"Tambahkan Catatan"},color:"primary",cancel:!0,persistent:!0}).onOk(_=>{s.catatan=_,l()})}return(_,i)=>(b(),w(Z,{position:"bottom-right",offset:[18,18]},{default:e(()=>[a(x,{rounded:"",color:"primary",label:"Submit","icon-right":"check",onClick:y,class:"q-pa-md"},{default:e(()=>[a(z,null,{default:e(()=>[u("Click to submit")]),_:1})]),_:1})]),_:1}))}}),Ta=T({__name:"PencairanDanaApprovalForm",props:{data:{}},setup(j){const p=j,m=R(),s=O({catatan:""});function l(){s.post(route("pencairan_dana.confirm",p.data.id_pencairan_dana),{onSuccess:n=>{m.notify({type:"positive",message:n.props.flash.success,position:"top"})}})}function y(){s.transform(n=>({...n,bertahap:!0})).post(route("pencairan_dana.confirm",p.data.id_pencairan_dana),{onSuccess:n=>{m.notify({type:"positive",message:n.props.flash.success,position:"top"})}})}function _(){s.post(route("pencairan_dana.reject",p.data.id_pencairan_dana),{onSuccess:n=>{m.notify({type:"positive",message:n.props.flash.success,position:"top"})}})}function i(){m.dialog({title:"Receipt Confirmation",message:"Are you sure want to perform this action?",prompt:{outlined:!0,autogrow:!0,model:"",type:"text",placeholder:"Tambahkan Catatan"},color:"positive",cancel:!0,persistent:!0}).onOk(n=>{s.catatan=n,l()})}function P(){m.dialog({title:"Receipt Confirmation",message:"Are you sure want to perform this action?",prompt:{outlined:!0,autogrow:!0,model:"",type:"text",placeholder:"Tambahkan Catatan"},color:"secondary",cancel:!0,persistent:!0}).onOk(n=>{s.catatan=n,y()})}function D(){m.dialog({title:"Rejection Confirmation",message:"Are you sure want to perform this action?",prompt:{outlined:!0,autogrow:!0,model:"",type:"text",placeholder:"Tambahkan Catatan"},color:"negative",cancel:!0,persistent:!0}).onOk(n=>{s.catatan=n,_()})}return(n,f)=>(b(),w(Z,{position:"bottom-right",offset:[18,18]},{default:e(()=>[a(Da,{color:"primary",icon:"keyboard_arrow_left",direction:"left"},{label:e(({opened:t})=>[g("div",{class:sa({"example-fab-animate--hover":t!==!0})},d(t!==!0?"Konfirmasi Penerimaan":"Close"),3)]),default:e(()=>[a(V,{color:"green",label:"Terima Lunas",icon:"check",onClick:i}),a(V,{color:"secondary",label:"Terima Bertahap",icon:"check",onClick:P}),a(V,{color:"red",label:"Tolak",icon:"clear",onClick:D})]),_:1})]),_:1}))}}),Va={class:"q-px-md q-pt-md"},$a={class:"row"},qa=g("div",{class:"col-4 text-caption"}," Keperluan ",-1),Aa={class:"col-8 text-subtitle2"},Ba=g("div",{class:"col-4 text-caption"}," Jenis Transaksi ",-1),Ua={class:"col-8 text-subtitle2"},Fa=g("div",{class:"col-4 text-caption"}," Tanggal Pengajuan ",-1),Ia={class:"col-8 text-subtitle2"},Ea={class:"q-px-md q-pt-md"},ne=T({__name:"DetailPencairanDanaPage",props:{pencairanDana:{},pengajuanDana:{},detailPencairanDana:{},detailPengajuanDana:{},dokumenPenunjang:{},timeline:{}},setup(j){const p=j,m=[{label:"Keuangan",url:"#"},{label:"Pencairan Dana",url:route("pencairan_dana")},{label:p.pencairanDana.nama_proyek,url:"#"}],s=q("uraian");return(l,y)=>{const _=ua("in-link");return b(),S(B,null,[a(r(da),{title:"Pencairan Dana"}),a(Y,null,{breadcrumbs:e(()=>[a(W,{align:"left"},{default:e(()=>[(b(),S(B,null,H(m,i=>ca(a(aa,{key:i.label,label:i.label},null,8,["label"]),[[_,i.url]])),64))]),_:1})]),default:e(()=>[a(ja,{title:"Pencairan Dana","timeline-title":"Timeline Pencairan Dana",data:{proyek:l.pencairanDana,status:l.pencairanDana.status_pencairan,timeline:l.timeline}},null,8,["data"]),g("div",Va,[a(E,{flat:"",bordered:"",style:{"max-width":"500px"}},{default:e(()=>[a(U,null,{default:e(()=>[g("div",$a,[qa,g("div",Aa," : "+d(l.pengajuanDana.keperluan),1),Ba,g("div",Ua," : "+d(l.pengajuanDana.jenis_transaksi),1),Fa,g("div",Ia," : "+d(r(fa)(l.pengajuanDana.tanggal_pengajuan)||"-"),1)])]),_:1})]),_:1})]),g("div",Ea,[a(E,{flat:"",bordered:""},{default:e(()=>[a(ma,{modelValue:s.value,"onUpdate:modelValue":y[0]||(y[0]=i=>s.value=i),class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:e(()=>[a(L,{"no-caps":"",name:"uraian",label:"Uraian"}),a(L,{"no-caps":"",name:"dokumen",label:"Dokumen Penunjang"})]),_:1},8,["modelValue"]),a(F),a(pa,{modelValue:s.value,"onUpdate:modelValue":y[1]||(y[1]=i=>s.value=i)},{default:e(()=>[a(J,{class:"q-pa-none",name:"uraian"},{default:e(()=>[a(r(Qa),{rows:l.detailPengajuanDana,data:{pencairanDana:l.pencairanDana,pengajuanDana:l.pengajuanDana,detailPencairanDana:l.detailPencairanDana}},null,8,["rows","data"])]),_:1}),a(J,{class:"q-pa-none",name:"dokumen"},{default:e(()=>[a(r(_a),{rows:l.dokumenPenunjang,data:{model_id:l.pencairanDana.id_pencairan_dana,permissions:"create & modify pencairan dana",status_aktivitas:l.pencairanDana.status_aktivitas}},null,8,["rows","data"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),r($)("create & modify pencairan dana")&&r(N)(l.pencairanDana)&&l.detailPencairanDana.length?(b(),w(r(Sa),{key:0,data:{id_pencairan_dana:l.pencairanDana.id_pencairan_dana}},null,8,["data"])):I("",!0),r($)("confirm pencairan dana")&&r(X)(l.pencairanDana)?(b(),w(r(Ta),{key:1,data:{id_pencairan_dana:l.pencairanDana.id_pencairan_dana}},null,8,["data"])):I("",!0)]),_:1})],64)}}});export{ne as default};
