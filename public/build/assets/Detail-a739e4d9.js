import{_ as W,a as X,C as Y}from"./Content-c6f442a5.js";import{C as aa,a as ea,_ as na}from"./Card-7d71d8a7.js";import{d as ta,K as ua,b as y,k as P,l as sa,e as H,c as U,h as e,u as a,g as n,F as q,o as r,Z as la,n as b,j as E,a as k,f as d,p as i,q as p,s as oa,t as c,m as L}from"./app-75a3a99f.js";import{T as ia,a as ra,_ as g,b as m,c as da,d as u}from"./Table-3adccec2.js";import{t as $,f as _a}from"./number-6d20867b.js";import{M}from"./modal-cb471a77.js";import{T as I}from"./toastify-1f71f880.js";import{_ as pa}from"./Create.m.vue_vue_type_script_setup_true_lang-705f837f.js";import{_ as ca}from"./Update.m.vue_vue_type_script_setup_true_lang-e3f4e105.js";import{_ as fa}from"./Delete.m.vue_vue_type_script_setup_true_lang-5f0d26d2.js";import{_ as ma}from"./Informasi.p.vue_vue_type_script_setup_true_lang-015a66cd.js";import{_ as ga}from"./Timeline.p.vue_vue_type_script_setup_true_lang-08b90951.js";import{_ as ka}from"./Persetujuan.p.vue_vue_type_script_setup_true_lang-24d94fc0.js";import{_ as ja}from"./Pengajuan.p.vue_vue_type_script_setup_true_lang-80a16eea.js";import{T as ha}from"./Foot-84934bbc.js";import"./Modal.vue_vue_type_style_index_0_scoped_fdb70d85_lang-9b77fc3b.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Footer-8b073701.js";import"./Head.vue_vue_type_script_setup_true_lang-0b8949ad.js";import"./Input.vue_vue_type_script_setup_true_lang-8599c816.js";import"./Label.vue_vue_type_script_setup_true_lang-21506f02.js";import"./Error.vue_vue_type_script_setup_true_lang-f9f51393.js";import"./Select.vue_vue_type_script_setup_true_lang-f552b2ec.js";import"./date-7cb373b2.js";import"./Textarea.vue_vue_type_script_setup_true_lang-3b042892.js";const va={class:"flex justify-between items-center"},ya=k("h5",{class:"font-bold text-xl text-dark"},"List Pengajuan Dana",-1),ba={class:"flex"},wa={class:"grid grid-cols-3 gap-6"},Ca={class:"col-span-2"},Qa=ta({__name:"Detail",props:{keuangan:{},detail_pengajuan_dana:{},pengajuan_dana:{},detail_rap:{},timeline:{},rekening:{}},setup(R){const f=R,j=ua(),w=j.props.role,C=j.props.permissions,T=y(()=>!!(w==="admin"||C.includes("create pengajuan dana")&&C.includes("update pengajuan dana")&&C.includes("delete pengajuan dana"))),x=y(()=>f.pengajuan_dana.status_aktivitas==="Dibuat"),h=y(()=>{const t=f.pengajuan_dana.status_aktivitas;if(C.includes("approve pengajuan dana")){if(w==="admin")switch(t){case"Diajukan":return!0;case"Dievaluasi":return!0;default:return!1}if(w==="kepala divisi")switch(t){case"Diajukan":return!0;default:return!1}if(w==="direktur utama")switch(t){case"Dievaluasi":return!0;default:return!1}}return!1}),D=y(()=>f.detail_pengajuan_dana.map(t=>{const s=$(t.jumlah_pengajuan);return{...t,jumlah_pengajuan_in_rupiah:s}})),v=y(()=>{const t=f.detail_pengajuan_dana.reduce((s,l)=>s+parseFloat(l.jumlah_pengajuan.toString()),0);return{pengajuan_dana:$(t),disetujui:$(F.value),ditolak:$(A.value)}}),S=P(),F=P(0),A=P(0);function N(t){const s=t.target;document.querySelectorAll(".persetujuan-checkbox").forEach(_=>{_ instanceof HTMLInputElement&&(_.checked=s.checked)}),B()}function B(){V(),O(),J()}function V(){const t=document.querySelectorAll(".persetujuan-checkbox");let s=[];t.forEach(l=>{l instanceof HTMLInputElement&&l.checked&&l.dataset.id&&s.push(parseFloat(l.dataset.id))}),S.value=s}function O(){const t=document.querySelectorAll(".persetujuan-checkbox");let s=0;t.forEach(l=>{if(l instanceof HTMLInputElement&&l.checked){const _=parseFloat(l.dataset.amount||"0");s+=_}}),F.value=s}function J(){const t=document.querySelectorAll(".persetujuan-checkbox"),s=_a(v.value.pengajuan_dana||"0");let l=0;t.forEach(_=>{if(_ instanceof HTMLInputElement&&_.checked){const o=parseFloat(_.dataset.amount||"0");l+=o}}),s&&(A.value=s-l)}function K(){M.pop(pa,{id_pengajuan_dana:f.pengajuan_dana.id_pengajuan_dana,detail_rap:f.detail_rap,rekening:f.rekening})}function z(t){M.pop(ca,{detail_pengajuan_dana:t,detail_rap:f.detail_rap,rekening:f.rekening})}function Z(t){M.pop(fa,{id_detail_pengajuan_dana:t})}return sa(()=>{j.props.flash.success&&I.success(j.props.flash.success),j.props.flash.error&&I.error(j.props.flash.error)}),(t,s)=>{const l=H("fas-icon"),_=H("ease-button");return r(),U(q,null,[e(a(la),{title:"Pengajuan Dana"}),e(W,null,{breadcrumb:n(()=>[e(X,b(E({second:"Keuangan",current:f.keuangan.nama_proyek})),null,16)]),default:n(()=>[e(Y,null,{default:n(()=>[e(ma,b(E({keuangan:t.keuangan,pengajuan_dana:t.pengajuan_dana})),null,16),e(a(aa),null,{default:n(()=>[e(a(ea),null,{default:n(()=>[k("div",va,[ya,T.value&&x.value?(r(),d(_,{key:0,onClick:K,slotted:""},{default:n(()=>[e(l,{icon:"fa-solid fa-plus",class:"mr-1"}),i(" Tambah Uraian ")]),_:1})):p("",!0)])]),_:1}),e(a(na),{table:""},{default:n(()=>[e(a(ia),null,{default:n(()=>[e(a(ra),null,{default:n(()=>[e(a(g),null,{default:n(()=>[e(a(m),{value:"#"}),e(a(m),{value:"Uraian"}),e(a(m),{value:"Pos"}),e(a(m),{value:"Jenis Pembayaran"}),e(a(m),{value:"Rekening"}),e(a(m),{value:"Bank"}),e(a(m),{"text-align":"right",value:"Jumlah Pengajuan"}),h.value?(r(),d(a(m),{key:0,value:"Persetujuan"})):p("",!0),T.value&&x.value?(r(),d(a(m),{key:1})):p("",!0)]),_:1})]),_:1}),e(a(da),null,{default:n(()=>[D.value.length?(r(!0),U(q,{key:0},oa(D.value,(o,G)=>(r(),d(a(g),{key:o.id_detail_pengajuan_dana},{default:n(()=>[e(a(u),null,{default:n(()=>[i(c(G+1),1)]),_:2},1024),e(a(u),{whitespace:"nowrap",class:"font-semibold text-dark"},{default:n(()=>[i(c(o.uraian),1)]),_:2},1024),e(a(u),{whitespace:"nowrap"},{default:n(()=>[i(c(o.uraian_rap),1)]),_:2},1024),e(a(u),{whitespace:"nowrap"},{default:n(()=>[i(c(o.jenis_pembayaran),1)]),_:2},1024),e(a(u),{whitespace:"nowrap"},{default:n(()=>[i(c(o.nomor_rekening)+" - "+c(o.nama_rekening),1)]),_:2},1024),e(a(u),{whitespace:"nowrap"},{default:n(()=>[i(c(o.nama_bank),1)]),_:2},1024),e(a(u),{whitespace:"nowrap","text-align":"right"},{default:n(()=>[i(c(o.jumlah_pengajuan_in_rupiah),1)]),_:2},1024),h.value?(r(),d(a(u),{key:0},{default:n(()=>[k("input",L({onChange:B},{type:"checkbox",class:"persetujuan-checkbox","data-id":o.id_detail_pengajuan_dana,"data-amount":o.jumlah_pengajuan}),null,16)]),_:2},1024)):p("",!0),T.value&&x.value?(r(),d(a(u),{key:1,whitespace:"nowrap"},{default:n(()=>[k("div",ba,[e(_,{variant:"link",text:"Edit",onClick:Q=>z(o)},null,8,["onClick"]),e(_,{variant:"danger-link",text:"Delete",onClick:Q=>Z(o.id_detail_pengajuan_dana)},null,8,["onClick"])])]),_:2},1024)):p("",!0)]),_:2},1024))),128)):(r(),d(a(g),{key:1,last:""},{default:n(()=>[e(a(u),{colspan:"8","text-align":"center"},{default:n(()=>[i(" Uraian tidak ditemukan ")]),_:1})]),_:1}))]),_:1}),D.value.length?(r(),d(a(ha),{key:0},{default:n(()=>[h.value?(r(),d(a(g),{key:0,last:""},{default:n(()=>[e(a(u),{colspan:"6"}),e(a(u),{"text-align":"right"},{default:n(()=>[i(" Setujui Semua ")]),_:1}),e(a(u),null,{default:n(()=>[k("input",{onChange:s[0]||(s[0]=o=>N(o)),type:"checkbox",title:"Setujui semua"},null,32)]),_:1})]),_:1})):p("",!0),e(a(g),{last:""},{default:n(()=>[e(a(u),{colspan:"5"}),e(a(u),{class:"font-semibold"},{default:n(()=>[i(" Total Pengajuan ")]),_:1}),e(a(u),{"text-align":"right",class:"font-semibold"},{default:n(()=>[i(c(v.value.pengajuan_dana),1)]),_:1})]),_:1}),h.value?(r(),d(a(g),{key:1,last:""},{default:n(()=>[e(a(u),{colspan:"5"}),e(a(u),{class:"font-semibold"},{default:n(()=>[i(" Disetujui ")]),_:1}),e(a(u),{"text-align":"right",class:"font-semibold"},{default:n(()=>[i(c(v.value.disetujui),1)]),_:1})]),_:1})):p("",!0),h.value?(r(),d(a(g),{key:2,last:""},{default:n(()=>[e(a(u),{colspan:"5"}),e(a(u),{class:"font-semibold"},{default:n(()=>[i(" Tidak Disetujui ")]),_:1}),e(a(u),{"text-align":"right",class:"font-semibold"},{default:n(()=>[i(c(v.value.ditolak),1)]),_:1})]),_:1})):p("",!0)]),_:1})):p("",!0)]),_:1})]),_:1})]),_:1}),k("div",wa,[k("div",Ca,[e(ga,b(E({timeline:t.timeline})),null,16)]),T.value&&x.value?(r(),d(ja,b(L({key:0},{id_pengajuan_dana:t.pengajuan_dana.id_pengajuan_dana,detail_pengajuan_dana_length:D.value.length})),null,16)):p("",!0),h.value?(r(),d(ka,b(L({key:1},{id_pengajuan_dana:t.pengajuan_dana.id_pengajuan_dana,group_of_id_detail_pengajuan_dana:S.value,total_amount:v.value})),null,16)):p("",!0)])]),_:1})]),_:1})],64)}}});export{Qa as default};
